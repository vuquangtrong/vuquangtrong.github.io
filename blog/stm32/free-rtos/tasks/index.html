
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Tasks are jobs will be done in an application. These special jobs are managed by scheduler with task's stack, priority." name="description"/>
<meta content="embedded systems application programming" name="keywords"/>
<meta content="vqtrong" name="author"/>
<link href="https://www.codeinsideout.com/blog/stm32/free-rtos/tasks/" rel="canonical"/>
<link href="../../../../favicon.png" rel="icon"/>
<meta content="mkdocs-1.2.2, mkdocs-material-7.2.2" name="generator"/>
<title>FreeRTOS - Tasks - Code Inside Out</title>
<link href="../../../../assets/stylesheets/main.1118c9be.min.css" rel="stylesheet"/>
<link href="../../../../assets/stylesheets/palette.ba0d045b.min.css" rel="stylesheet"/>
<meta content="#ffffff" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Noto+Serif:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Noto Serif";--md-code-font-family:"Roboto Mono"}</style>
<link href="../../../../assets/view-bigimg.css" rel="stylesheet"/>
<link href="../../../../assets/extra.css" rel="stylesheet"/>
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-42618265-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<meta content="website" property="og:type">
<meta content="FreeRTOS - Tasks - Code Inside Out" property="og:title">
<meta content="Tasks are jobs will be done in an application. These special jobs are managed by scheduler with task's stack, priority." property="og:description">
<meta content="https://www.codeinsideout.com/blog/stm32/free-rtos/tasks/" property="og:url">
<meta content="https://www.codeinsideout.com/assets/banner.jpg" property="og:image">
<meta content="Code Inside Out" property="og:site_name">
<meta content="summary" name="twitter:card">
</meta></meta></meta></meta></meta></meta></meta></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="white" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("../../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#1-a-task">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Code Inside Out" class="md-header__button md-logo" data-md-component="logo" href="../../../.." title="Code Inside Out">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="m278.9 511.5-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2 43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6 144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Code Inside Out
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Tasks
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../..">
      Home
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../../../">
      Blog
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../projects/">
      Projects
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../../tags/">
      Tags
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<style>
        .tag-cloud-toc {
            display: none;
        }
        @media screen and (max-width: 76.1875em) {
            .tag-cloud-toc {
                display: block;
            }
        }
    </style>
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Code Inside Out" class="md-nav__button md-logo" data-md-component="logo" href="../../../.." title="Code Inside Out">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="m278.9 511.5-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2 43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6 144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"></path></svg>
</a>
    Code Inside Out
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../" style="margin: initial; padding: initial; pointer-events: initial">
        
          Blog
        </a>
</label>
<nav aria-label="Blog" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../" style="margin: initial; padding: initial; pointer-events: initial">
          
            Blog
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" id="__nav_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../" style="margin: initial; padding: initial; pointer-events: initial">
        
          STM32
        </a>
</label>
<nav aria-label="STM32" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../" style="margin: initial; padding: initial; pointer-events: initial">
          
            STM32
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../intro/">
        Introduction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../prepare/">
        Preparation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../tools/">
        Toolchain
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../docs/">
        Documents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../clock/">
        Clock Tree
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../interrupt/">
        Interrupt
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../semihosting/">
        Semihosting
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../gpio/">
        GPIO
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../dma/">
        DMA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../swv/">
        SWV
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../add-swo/">
        Add SWO
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../uart/">
        UART
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../uart-redirection/">
        UART Redirection
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../timer/">
        Timers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../sensor-us-100/">
        US-100 Sensor
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../adc/">
        ADC
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../i2c-spi/">
        I2C - SPI
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../oled-ssd1306/">
        SSD1306 OLED
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1_19" id="__nav_2_1_19" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_1_19">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../overview/" style="margin: initial; padding: initial; pointer-events: initial">
        
          FreeRTOS
        </a>
</label>
<nav aria-label="FreeRTOS" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_1_19">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../overview/" style="margin: initial; padding: initial; pointer-events: initial">
          
            FreeRTOS
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../systick/">
        SysTick &amp; Delay
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../memory/">
        Memory
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../interrupt/">
        Interrupt
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link md-nav__link--active" href="./" style="margin: initial; padding: initial; pointer-events: initial">
          
            Tasks
          </a>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Tasks
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-a-task">
    1. A Task
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-startup">
    2. Startup
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-the-idle-task">
    3. The IDLE Task
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-task-lists">
    4. Task Lists
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-task-functions">
    5. Task Functions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-task-states">
    6. Task states
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7-task-priorities">
    7. Task priorities
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8-task-context-switching">
    8. Task context switching
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#9-lab-0-tasks">
    9. Lab 0: Tasks
  </a>
<nav aria-label="9. Lab 0: Tasks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#91-enable-uart-redirection">
    9.1. Enable UART redirection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#92-define-a-param-for-tasks">
    9.2. Define a param for tasks
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#93-add-2-tasks">
    9.3. Add 2 Tasks
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#94-build-and-run">
    9.4. Build and Run
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#95-change-priority">
    9.5. Change Priority
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#96-use-os-delay">
    9.6. Use OS Delay
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#10-other-tasks-functions">
    10. Other Tasks functions
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../reentrant/">
        Reentrant
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../stack/">
        Stack Overflow
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../j-link-rtt/">
        J-Link RTT
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../j-link-sysview/">
        J-Link SysView
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../notes/">
        Notes
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../pi/" style="margin: initial; padding: initial; pointer-events: initial">
        
          Raspberry Pi
        </a>
</label>
<nav aria-label="Raspberry Pi" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../pi/" style="margin: initial; padding: initial; pointer-events: initial">
          
            Raspberry Pi
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/headless-mode/">
        Headless mode
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/compile-ffmpeg/">
        Compile FFmpeg
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/resource-usage/">
        Resource usage
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/setup-camera/">
        Setup Camera
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/stream-ffmpeg-hls-dash/">
        HLS/DASH Streaming
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/stream-picamera-mjpeg/">
        MJPEG streaming
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/stream-picamera-h264/">
        H264 streaming
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/backup-sdcard/">
        Backup SDCard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/check-camera-i2c/">
        Diagnostic Camera
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/ubuntu/">
        Ubuntu
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../pi/notes/">
        Notes
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../c-cpp/" style="margin: initial; padding: initial; pointer-events: initial">
        
          C/C++
        </a>
</label>
<nav aria-label="C/C++" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../c-cpp/" style="margin: initial; padding: initial; pointer-events: initial">
          
            C/C++
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../c-cpp/notes/">
        Notes
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../lidar/" style="margin: initial; padding: initial; pointer-events: initial">
        
          Lidar
        </a>
</label>
<nav aria-label="Lidar" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../lidar/" style="margin: initial; padding: initial; pointer-events: initial">
          
            Lidar
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../lidar/livox-sdk/">
        Livox SDK
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../linux/" style="margin: initial; padding: initial; pointer-events: initial">
        
          Linux
        </a>
</label>
<nav aria-label="Linux" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../linux/" style="margin: initial; padding: initial; pointer-events: initial">
          
            Linux
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../linux/byobu/">
        Byobu
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../linux/dual-boot/">
        Dual Boot
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../linux/samba/">
        Samba
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../linux/tweaks/">
        Tweaks
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" id="__nav_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_6">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../ros/" style="margin: initial; padding: initial; pointer-events: initial">
        
          ROS
        </a>
</label>
<nav aria-label="ROS" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_6">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../ros/" style="margin: initial; padding: initial; pointer-events: initial">
          
            ROS
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../ros/tutorial-beginner/">
        Tutorial for Beginners
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" id="__nav_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_7">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../setup-blog/" style="margin: initial; padding: initial; pointer-events: initial">
        
          Setup blog
        </a>
</label>
<nav aria-label="Setup blog" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_7">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../setup-blog/" style="margin: initial; padding: initial; pointer-events: initial">
          
            Setup blog
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../setup-blog/markdown-syntax/">
        Markdown syntax
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../setup-blog/mkdocs-plugins/">
        MkDocs plugins
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../setup-blog/customize-theme/">
        Customize theme
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../setup-blog/print-to-pdf/">
        Print to PDF
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../setup-blog/fix-ajax-issue/">
        Fix AJAX issue
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_8" id="__nav_2_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_8">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../virtual-machine/" style="margin: initial; padding: initial; pointer-events: initial">
        
          Virtual machine
        </a>
</label>
<nav aria-label="Virtual machine" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_8">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../../virtual-machine/" style="margin: initial; padding: initial; pointer-events: initial">
          
            Virtual machine
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../../virtual-machine/docker/">
        Docker
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../virtual-machine/hyper-v/">
        Hyper-V
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../projects/">
        Projects
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../../tags/">
        Tags
      </a>
</li>
</ul>
</nav>
<div class="tag-cloud-nav">
<p class="md-nav" style="margin-bottom: 0.5em;">
<label class="md-nav__title">Tag cloud</label>
</p>
<div class="tag-cloud-content">
<a class="tag" href="https://www.codeinsideout.com/tags/#sdcard">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">sdcard</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#picamera">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkOrchid;
        ">picamera</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#linux">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkOliveGreen;
        ">linux</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sharing">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">sharing</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pwm">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">pwm</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#dash">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">dash</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ros">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkViolet;
        ">ros</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#semihosting">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">semihosting</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#gpio">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">gpio</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#c++">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">c++</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pdf">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">pdf</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#container">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">container</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ssd1306">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">ssd1306</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#lidar">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkRed;
        ">lidar</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#board">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">board</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#hls">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">hls</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#hyper-v">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkCyan;
        ">hyper-v</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stack">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">stack</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#capture">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">capture</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#distance">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">distance</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mkdocs">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkOrchid;
        ">mkdocs</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#interrupt">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkGoldenrod;
        ">interrupt</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#joystick">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">joystick</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#clock">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">clock</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sensor">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">sensor</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#c">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">c</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#performance">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">performance</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#debug">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkGreen;
        ">debug</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#v4l2">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">v4l2</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#notes">
<span class="tag-name" style="
          font-size:0.7rem;
          color:DarkCyan;
        ">notes</span>
<!--<sup class="tag-count">4</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#javascript">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkBlue;
        ">javascript</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#jinja">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">jinja</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#adc">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">adc</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#toolchain">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">toolchain</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#timer">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">timer</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#uart">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkTurquoise;
        ">uart</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#reentrant">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">reentrant</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#samba">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">samba</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#redirect">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">redirect</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#bash">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">bash</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mapping">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">mapping</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#headless">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">headless</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#docs">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">docs</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#camera">
<span class="tag-name" style="
          font-size:0.8rem;
          color:DarkMagenta;
        ">camera</span>
<!--<sup class="tag-count">6</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#systick">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">systick</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ajax">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">ajax</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#dma">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkRed;
        ">dma</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#python">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkBlue;
        ">python</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pulse">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">pulse</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ffmpeg">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkCyan;
        ">ffmpeg</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#spi">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">spi</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stream">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkSlateGray;
        ">stream</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#swv">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">swv</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#h264">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">h264</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#livox">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">livox</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sysview">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">sysview</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#usart">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">usart</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#css">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">css</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#arm">
<span class="tag-name" style="
          font-size:1.6500000000000001rem;
          color:DarkGoldenrod;
        ">arm</span>
<!--<sup class="tag-count">23</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#oled">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">oled</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#raspberry-pi">
<span class="tag-name" style="
          font-size:1.05rem;
          color:DarkRed;
        ">raspberry-pi</span>
<!--<sup class="tag-count">11</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#virtual-machine">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkGreen;
        ">virtual-machine</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#i2c">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkOliveGreen;
        ">i2c</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#rtt">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkOliveGreen;
        ">rtt</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#docker">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">docker</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#gps">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">gps</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stm32">
<span class="tag-name" style="
          font-size:1.75rem;
          color:DarkRed;
        ">stm32</span>
<!--<sup class="tag-count">25</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pi">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">pi</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#virtual">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">virtual</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#html">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkCyan;
        ">html</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#material">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">material</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#rtos">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkSlateGray;
        ">rtos</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#memory">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkMagenta;
        ">memory</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#markdown">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">markdown</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mjpeg">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">mjpeg</span>
<!--<sup class="tag-count">1</sup>-->
</a>
</div>
</div>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-a-task">
    1. A Task
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-startup">
    2. Startup
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-the-idle-task">
    3. The IDLE Task
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-task-lists">
    4. Task Lists
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-task-functions">
    5. Task Functions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-task-states">
    6. Task states
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7-task-priorities">
    7. Task priorities
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8-task-context-switching">
    8. Task context switching
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#9-lab-0-tasks">
    9. Lab 0: Tasks
  </a>
<nav aria-label="9. Lab 0: Tasks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#91-enable-uart-redirection">
    9.1. Enable UART redirection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#92-define-a-param-for-tasks">
    9.2. Define a param for tasks
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#93-add-2-tasks">
    9.3. Add 2 Tasks
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#94-build-and-run">
    9.4. Build and Run
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#95-change-priority">
    9.5. Change Priority
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#96-use-os-delay">
    9.6. Use OS Delay
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#10-other-tasks-functions">
    10. Other Tasks functions
  </a>
</li>
</ul>
</nav>
<div class="tag-cloud-toc">
<p class="md-nav" style="margin-bottom: 0.5em;">
<label class="md-nav__title">Tag cloud</label>
</p>
<div class="tag-cloud-content">
<a class="tag" href="https://www.codeinsideout.com/tags/#jinja">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">jinja</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#systick">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">systick</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#v4l2">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">v4l2</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mkdocs">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkOrchid;
        ">mkdocs</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#javascript">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkOrchid;
        ">javascript</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#spi">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">spi</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#redirect">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">redirect</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ssd1306">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">ssd1306</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mjpeg">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">mjpeg</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#gpio">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">gpio</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#semihosting">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">semihosting</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#memory">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkGreen;
        ">memory</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#virtual-machine">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkSlateGray;
        ">virtual-machine</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ffmpeg">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkSlateGray;
        ">ffmpeg</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#toolchain">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">toolchain</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sharing">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">sharing</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#adc">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">adc</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#lidar">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkRed;
        ">lidar</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sensor">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">sensor</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sdcard">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">sdcard</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#linux">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkViolet;
        ">linux</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sysview">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">sysview</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#hyper-v">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">hyper-v</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stack">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">stack</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#c">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">c</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#markdown">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">markdown</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#picamera">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkSlateGray;
        ">picamera</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#reentrant">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">reentrant</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#timer">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">timer</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#docs">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">docs</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#rtt">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkMagenta;
        ">rtt</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#uart">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkRed;
        ">uart</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#interrupt">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkGreen;
        ">interrupt</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#samba">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">samba</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#c++">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">c++</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#rtos">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkOrchid;
        ">rtos</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pi">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkCyan;
        ">pi</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#docker">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">docker</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ajax">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">ajax</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pwm">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">pwm</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#performance">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkCyan;
        ">performance</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#i2c">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkRed;
        ">i2c</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stm32">
<span class="tag-name" style="
          font-size:1.75rem;
          color:DarkOliveGreen;
        ">stm32</span>
<!--<sup class="tag-count">25</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#swv">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">swv</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pulse">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">pulse</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#notes">
<span class="tag-name" style="
          font-size:0.7rem;
          color:DarkOrchid;
        ">notes</span>
<!--<sup class="tag-count">4</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#board">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">board</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#bash">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">bash</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#hls">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">hls</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#css">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">css</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#joystick">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">joystick</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#virtual">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">virtual</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#container">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">container</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#gps">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">gps</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#clock">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">clock</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#dash">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">dash</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#raspberry-pi">
<span class="tag-name" style="
          font-size:1.05rem;
          color:DarkCyan;
        ">raspberry-pi</span>
<!--<sup class="tag-count">11</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#oled">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">oled</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#debug">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkOrchid;
        ">debug</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#html">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">html</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#headless">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">headless</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#dma">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkBlue;
        ">dma</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#material">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">material</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mapping">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">mapping</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#python">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkGreen;
        ">python</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#capture">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">capture</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#distance">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">distance</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#livox">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">livox</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stream">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkCyan;
        ">stream</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ros">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkBlue;
        ">ros</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pdf">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">pdf</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#usart">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">usart</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#h264">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">h264</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#arm">
<span class="tag-name" style="
          font-size:1.6500000000000001rem;
          color:DarkBlue;
        ">arm</span>
<!--<sup class="tag-count">23</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#camera">
<span class="tag-name" style="
          font-size:0.8rem;
          color:DarkGoldenrod;
        ">camera</span>
<!--<sup class="tag-count">6</sup>-->
</a>
</div>
</div>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<style>
            .md-typeset .cover {
                margin-bottom: 1em;
            }
            @media print {
                .md-typeset .cover {
                    height: 100vh;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                }
            }
        </style>
<div class="cover">
<h1 class="page-title">FreeRTOS - Tasks</h1>
<p class="page-description">Tasks are jobs will be done in an application. These special jobs are managed by scheduler with task's stack, priority.</p>
<p class="page-tags">
<a class="tag" href="https://www.codeinsideout.com/tags/#arm">
<span class="tag-name">
                        #arm
                    </span>
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stm32">
<span class="tag-name">
                        #stm32
                    </span>
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#rtos">
<span class="tag-name">
                        #rtos
                    </span>
</a>
</p>
<p class="md-source-date">
<hr style="margin-bottom: .5em;"/>
<small>
                            Last update:
                            <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2021-08-08 09:12:52</span>
</small>
</p>
</div>
<style>
            .md-typeset .toc {
                display: none;
            }
            .md-typeset .toc label {
                display: none;
            }
            .md-typeset .toc .md-nav {
                font-size: unset;
                line-height: 1.6;
            }
            .md-typeset .toc .md-nav--secondary {
                margin-left: -2em;
            }
            .md-typeset .toc .md-nav__list {
                margin: 0;
            }
            .md-typeset .toc ul {
                list-style: none;
            }
            @media print {
                .md-typeset .toc {
                    display: block;
                    page-break-after: always;
                }
                .md-typeset .toc .md-nav__link {
                    color: var(--md-typeset-a-color);
                }
                .md-typeset .toc .md-nav__link.md-nav__link--active {
                    font-weight: unset;
                }
            }
        </style>
<div class="toc">
<h2>Table of Content</h2>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-a-task">
    1. A Task
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-startup">
    2. Startup
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-the-idle-task">
    3. The IDLE Task
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-task-lists">
    4. Task Lists
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-task-functions">
    5. Task Functions
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-task-states">
    6. Task states
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#7-task-priorities">
    7. Task priorities
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#8-task-context-switching">
    8. Task context switching
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#9-lab-0-tasks">
    9. Lab 0: Tasks
  </a>
<nav aria-label="9. Lab 0: Tasks" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#91-enable-uart-redirection">
    9.1. Enable UART redirection
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#92-define-a-param-for-tasks">
    9.2. Define a param for tasks
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#93-add-2-tasks">
    9.3. Add 2 Tasks
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#94-build-and-run">
    9.4. Build and Run
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#95-change-priority">
    9.5. Change Priority
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#96-use-os-delay">
    9.6. Use OS Delay
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#10-other-tasks-functions">
    10. Other Tasks functions
  </a>
</li>
</ul>
</nav>
</div>
<div class="btn-actions screen-only">
<p><a class="md-button" href="..\..\..\..\pdfs\blog\stm32\free-rtos\tasks\free-rtos__Tasks.pdf"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7z"></path></svg></span>PDF</a><a class="md-button" href="https://github.com/vuquangtrong/STM32-Tutorials/blob/main/Archives/F411CE_FreeRTOS_Tasks.zip"><span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="m278.9 511.5-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2 43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6 144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"></path></svg></span> F411CE_FreeRTOS_Tasks.zip</a></p>
</div>
<h2 id="1-a-task">1. A Task<a class="headerlink" href="#1-a-task" title="Permanent link">⚓︎</a></h2>
<p>A task will do a specific functionality, such as toggling an LED, reading an input. The task function usually is in infinite loop, it means a task will continuously run and never returns.</p>
<p>The Task Function is declared as:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span> <span class="nf">taskFunctionName</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(;;)</span> <span class="p">{</span>
        <span class="c1">// do things over and over</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>In freeRTOS, every task has its own stack that stores TCB (Task Control Block) and other stack-related operations while the task is being executed. It also stores processor context before a context switch (switching to other task). Stack size must be sufficient to accommodate all local variables and processor context.</p>
<h2 id="2-startup">2. Startup<a class="headerlink" href="#2-startup" title="Permanent link">⚓︎</a></h2>
<style>
    .md-typeset ol ol, .md-typeset ul ol {
        list-style-type: numeric;
    }
</style>
<ol>
<li>
<p>Main Application sets up the System Clock and necessary Peripherals</p>
</li>
<li>
<p>FreeRTOS is started by the <code>osKernelStart()</code> function in the <code>main.c</code> file from CMSIS_OS APIs:</p>
<ol>
<li>
<p>This calls to the <code>vTaskStartScheduler()</code> function from FreeRTOS APIs</p>
</li>
<li>
<p><code>vTaskStartScheduler()</code> creates an IDLE task using <code>xTaskCreate()</code>, then disables all interrupts by calling <code>portDISABLE_INTERRUPTS()</code> to be sure that no tick will happened before or during the call to <code>xPortStartScheduler()</code> function from FreeRTOS API</p>
</li>
<li>
<p><code>xPortStartScheduler()</code> configures the lowest priority level for <code>SysTick</code> and <code>PendSV</code> interrupts, then it starts the timer that generates the SysTick, enables FPU if presented (e.g. in CortexM4) and starts the first task using the <code>prvPortStartFirstTask()</code> function</p>
</li>
<li>
<p><code>prvPortStartFirstTask()</code> function (usually written in assembler) locates the stack and set <code>MSP</code> (used by the OS) to the start of the stack, then enables all interrupts. After this, it triggers software interrupt <code>SVC 0</code></p>
</li>
<li>
<p>As the result of SVC interrupt, <code>vPortSVCHandler()</code> is called</p>
</li>
<li>
<p><code>vPortSVCHandler()</code> restores the context, loads TCB (Task Block Control) of the first task (the highest priority one) from the Ready list and starts executing this task</p>
</li>
</ol>
</li>
</ol>
<h2 id="3-the-idle-task">3. The <code>IDLE</code> Task<a class="headerlink" href="#3-the-idle-task" title="Permanent link">⚓︎</a></h2>
<p>The Idle task is created automatically when the scheduler is started:</p>
<ul>
<li>It is the <code>portTASK_FUNCTION()</code> function in the <code>task.c</code> file</li>
<li>It performs the following operations (in endless loop):<ol>
<li>Check for deleted tasks to clean the memory</li>
<li>Call <code>taskYIELD()</code> if not using preemption <code>configUSE_PREEMPTION = 0</code></li>
<li>Call <code>taskYIELD()</code> if there is another task waiting and <code>configIDLE_SHOULD_YIELD = 1</code> to not waste time</li>
<li>Executes <code>vApplicationIdleHook()</code> if <code>configUSE_IDLE_HOOK = 1</code></li>
<li>Perform low power entrance if <code>configUSE_TICKLESS_IDLE != 0</code></li>
</ol>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">The default task</p>
<p>When using STM32CubeIDE to add FreeRTOS to project, there is a <em class="noem">default task</em> which is marked as <em class="noem">can be modified, not be removed</em>. This not the IDLE task mentioned above. User can configure it as a normal task, or even remove it in the main source code.</p>
<!-- <figure><img src="the_default_task.png" /><figcaption>The default task</figcaption></figure> -->
</div>
<h2 id="4-task-lists">4. Task Lists<a class="headerlink" href="#4-task-lists" title="Permanent link">⚓︎</a></h2>
<table>
<thead>
<tr>
<th>Task List</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ReadyTasksList[]</code></td>
<td>Prioritized ready tasks lists separate for each task priority up to <code>configMAX_PRIORITIES</code></td>
</tr>
<tr>
<td><code>TasksWaitingTermination</code></td>
<td>List of tasks which have been deleted but their memory pools are not freed yet.</td>
</tr>
<tr>
<td><code>SuspendedTaskList</code></td>
<td>List of tasks currently suspended</td>
</tr>
<tr>
<td><code>PendingReadyTaskList</code></td>
<td>Lists of tasks that have been read while the scheduler was suspended</td>
</tr>
<tr>
<td><code>DelayedTaskList</code></td>
<td>List of delayed tasks</td>
</tr>
<tr>
<td><code>OverflowDelayedTaskList</code></td>
<td>List of delayed tasks which have overflowed the current tick count</td>
</tr>
</tbody>
</table>
<div class="admonition info nt">
<p class="admonition-title"> </p>
<p>There is no dedicated list for task in Running mode (as there is only one task in this state at the moment), but the currently run task ID is stored in variable <code>pxCurrentTCB</code>.</p>
</div>
<div class="np"></div>
<h2 id="5-task-functions">5. Task Functions<a class="headerlink" href="#5-task-functions" title="Permanent link">⚓︎</a></h2>
<p>A task will do a specific functionality, such as toggling an LED, reading an input. The task function usually is in infinite loop, it means a task will continuously run and never returns.
The Task Function is declared as:</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span> <span class="nf">taskFunctionName</span><span class="p">(</span><span class="kt">void</span><span class="o">*</span> <span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// do something first</span>
    <span class="k">for</span><span class="p">(;;)</span> <span class="p">{</span>
        <span class="c1">// do things over and over</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>In freeRTOS, every task has its own stack that stores TCB (Task Control Block) and other stack-related operations while the task is being executed. It also stores processor context before a context switch (switching to other task). Stack size must be sufficient to accommodate all local variables and processor context.</p>
<p>A Task is created by calling <code>osThreadNew()</code> which indeed calls to:</p>
<ul>
<li><code>xTaskCreateStatic()</code> if <code>configSUPPORT_STATIC_ALLOCATION == 1</code>, or calls to</li>
<li><code>xTaskCreate()</code> if <code>configSUPPORT_DYNAMIC_ALLOCATION == 1</code>.</li>
</ul>
<p>The argument passed to the Task Function is declared as a <code>void*</code> pointer. This help to pass any type of data into the function handler.</p>
<h2 id="6-task-states">6. Task states<a class="headerlink" href="#6-task-states" title="Permanent link">⚓︎</a></h2>
<div class="row">
<div class="col">
<dl>
<dt><strong>Ready</strong></dt>
<dd>Task is ready to be executed but is not currently executing because a different task with equal or higher priority is running</dd>
<dt><strong>Running</strong></dt>
<dd>Task is actually running (only one can be in this state at the moment)</dd>
<dt><strong>Blocked</strong></dt>
<dd>Task is waiting for either a temporal or an external event</dd>
<dt><strong>Suspended</strong></dt>
<dd>Task not available for scheduling, but still being kept in memory</dd>
</dl>
</div>
<div class="col">
<p>
<figure class="w70"><img src="task_states.drawio.svg"/><figcaption>Task states</figcaption></figure>
</p>
</div>
</div>
<h2 id="7-task-priorities" style="margin-top:0">7. Task priorities<a class="headerlink" href="#7-task-priorities" title="Permanent link">⚓︎</a></h2>
<ul>
<li>
<p>Each task is assigned a priority from <code>tskIDLE_PRIORITY</code> <span class="critic comment">defined in task.h</span> to <code>MAX_PRIORITIES – 1</code> <span class="critic comment">defined in FreeRTOSConfig.h</span>.</p>
</li>
<li>
<p>The order of execution of tasks depends on this priority. The scheduler activates the task that has the highest priority of all tasks in the READY state.</p>
</li>
<li>
<p>A Task with higher priority can preempt the running task if <code>configUSE_PREEMPTION = 1</code> <span class="critic comment"> defined in FreeRTOSConfig.h</span></p>
</li>
</ul>
<table>
<thead>
<tr>
<th>Priority name</th>
<th>Value</th>
<th>Comment</th>
</tr>
</thead>
<tbody>
<tr>
<td>osPriorityIdle</td>
<td>-3</td>
<td>priority: idle (lowest)</td>
</tr>
<tr>
<td>osPriorityLow</td>
<td>-2</td>
<td>priority: low</td>
</tr>
<tr>
<td>osPriorityBelowNormal</td>
<td>-1</td>
<td>priority: below normal</td>
</tr>
<tr>
<td>osPriorityNormal</td>
<td>0</td>
<td>priority: normal (default)</td>
</tr>
<tr>
<td>osPriorityAboveNormal</td>
<td>1</td>
<td>priority: above normal</td>
</tr>
<tr>
<td>osPriorityHigh</td>
<td>2</td>
<td>priority: high</td>
</tr>
<tr>
<td>osPriorityRealtime</td>
<td>3</td>
<td>priority: realtime (highest)</td>
</tr>
<tr>
<td>osPriorityError</td>
<td>0x84</td>
<td>system cannot determine priority or thread has illegal priority</td>
</tr>
</tbody>
</table>
<p>
<figure class="w80"><img src="task_priority.png"/><figcaption>Task priority and execution order</figcaption></figure>
</p>
<h2 id="8-task-context-switching">8. Task context switching<a class="headerlink" href="#8-task-context-switching" title="Permanent link">⚓︎</a></h2>
<p>The process of saving the context of a task that is being suspended and restoring the context of a task being resumed is called context switching.</p>
<p>There are two 2 triggers that cause context switching:</p>
<ol>
<li>
<p><strong>SysTick interrupt</strong>
   This interrupt is used as a periodical signal to check if system needs to switch to another task.</p>
<ul>
<li>The interrupt causes <code>xPortSysTickHandler()</code> run</li>
<li><code>xPortSysTickHandler()</code> will:<ul>
<li>blocks all interrupts (as its own priority is the lowest one) using <code>portDISABLE_INTERRUPTS()</code></li>
<li>activates the PendSV bit to trigger <code>xPortPendSVHandler()</code>:<ul>
<li>calls to <code>vTaskSwitchContext()</code> function which selects the highest priority task in the READY List using the macro <code>taskSELECT_HIGHEST_PRIORITY_TASK()</code></li>
</ul>
</li>
<li>unblocks all interrupts using <code>portENABLE_INTERRUPT()</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Task yield</strong>
   When a task has done its work, it can trigger a context switching by send a yield by calling to <code>portYIELD()</code> which will set the PendSV bit to trigger <code>xPortPendSVHandler()</code> and start the scheduler (see above sequence).</p>
<p>Here are some cases that a task yield is called:</p>
<ul>
<li>The idle task is done its internal task, it calls to <code>taskYIELD()</code></li>
<li>When a task is in the block state, such as it has a delay or delayUntil function call, using <code>portYIELD_WITHIN_API()</code></li>
<li>When an interrupt unblocks a task using <code>portYIELD_FROM_ISR()</code></li>
</ul>
</li>
</ol>
<h2 id="9-lab-0-tasks">9. Lab 0: Tasks<a class="headerlink" href="#9-lab-0-tasks" title="Permanent link">⚓︎</a></h2>
<p>Star a new project with FreeRTOS included in STM32CubeIDE. Refer to the <a href="../overview/#32-enable-rtos">Lab: Overview</a>.</p>
<p>At this time, tasks will be added manually in code, without using the code generation in CubeMX. This project can be targeted on any MCU which has enough RAM to hold FreeRTOS.</p>
<p>Here are the settings needed for the lab:</p>
<ol>
<li>HAL Timebase is assigned to a general timer, let FreeRTOS use the SysTick</li>
<li>UART1 is enabled for printing debug information, note the pinout.</li>
<li>Select CMSIS_OS version 2, and use default FreeRTOS settings</li>
<li>Enable re-entrant settings for using FreeRTOS with <code>newlib</code>. Read more in <a href="../reentrant/">FreeRTOS newlib reentrant</a>.</li>
</ol>
<h3 id="91-enable-uart-redirection">9.1. Enable UART redirection<a class="headerlink" href="#91-enable-uart-redirection" title="Permanent link">⚓︎</a></h3>
<p>It is useful to print out debug information, and to make it easier, <a href="../../uart-redirection/">UART redirection</a> will be used. In this lab, it can be implemented in a minimal method by overriding the low-level <code>_write</code> function in the main file. Inside this function, a blocking call will be used to make sure all data is written in multi-thread. The correct method of synchronization will be discussed later.</p>
<div class="file"></div>
<p>main.c</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="nf">_write</span><span class="p">(</span><span class="kt">int</span> <span class="n">file</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">ptr</span><span class="p">,</span> <span class="kt">int</span> <span class="n">len</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// block write to UART if it is not ready</span>
<span class="hll">    <span class="k">while</span><span class="p">(</span><span class="n">HAL_UART_GetState</span><span class="p">(</span><span class="o">&amp;</span><span class="n">huart1</span><span class="p">)</span> <span class="o">!=</span> <span class="n">HAL_UART_STATE_READY</span><span class="p">);</span>
</span>
    <span class="n">HAL_StatusTypeDef</span> <span class="n">hstatus</span> <span class="o">=</span>
<span class="hll">        <span class="n">HAL_UART_Transmit</span><span class="p">(</span><span class="o">&amp;</span><span class="n">huart1</span><span class="p">,</span> <span class="p">(</span><span class="kt">uint8_t</span><span class="o">*</span><span class="p">)</span> <span class="n">ptr</span><span class="p">,</span> <span class="n">len</span><span class="p">,</span> <span class="n">HAL_MAX_DELAY</span><span class="p">);</span>
</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">hstatus</span> <span class="o">==</span> <span class="n">HAL_OK</span> <span class="o">?</span> <span class="nl">len</span> <span class="p">:</span> <span class="mi">0</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="92-define-a-param-for-tasks">9.2. Define a param for tasks<a class="headerlink" href="#92-define-a-param-for-tasks" title="Permanent link">⚓︎</a></h3>
<p>In this example, two tasks will count characters in a range which is defined in a structure as below:</p>
<div class="highlight"><pre><span></span><code><span class="k">typedef</span> <span class="k">struct</span> <span class="p">{</span>
  <span class="kt">uint8_t</span> <span class="n">start</span><span class="p">;</span>
  <span class="kt">uint8_t</span> <span class="n">end</span><span class="p">;</span>
<span class="p">}</span> <span class="n">CounterRange_t</span><span class="p">;</span>
</code></pre></div>
<p>The first task will count from <code>0</code> to <code>9</code>, while the second tasks will count from <code>A</code> to <code>J</code>.</p>
<div class="highlight"><pre><span></span><code><span class="n">CounterRange_t</span> <span class="n">Task1_CounterRange</span> <span class="o">=</span> <span class="p">{</span><span class="sc">'0'</span><span class="p">,</span> <span class="sc">'9'</span><span class="p">};</span>
<span class="n">CounterRange_t</span> <span class="n">Task2_CounterRange</span> <span class="o">=</span> <span class="p">{</span><span class="sc">'A'</span><span class="p">,</span> <span class="sc">'J'</span><span class="p">};</span>
</code></pre></div>
<h3 id="93-add-2-tasks">9.3. Add 2 Tasks<a class="headerlink" href="#93-add-2-tasks" title="Permanent link">⚓︎</a></h3>
<p>Define two tasks in the main file. At this moment, two tasks will have the same priority as <code>osPriorityNormal</code> level.</p>
<div class="file"></div>
<p>main.c</p>
<div class="highlight"><pre><span></span><code><span class="n">osThreadId_t</span> <span class="n">Task1_Handle</span><span class="p">;</span>
<span class="k">const</span> <span class="n">osThreadAttr_t</span> <span class="n">Task1_attributes</span> <span class="o">=</span> <span class="p">{</span>
<span class="hll">  <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"Task1"</span><span class="p">,</span>
</span>  <span class="p">.</span><span class="n">stack_size</span> <span class="o">=</span> <span class="mi">128</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
<span class="hll">  <span class="p">.</span><span class="n">priority</span> <span class="o">=</span> <span class="p">(</span><span class="n">osPriority_t</span><span class="p">)</span> <span class="n">osPriorityNormal</span><span class="p">,</span>
</span><span class="p">};</span>

<span class="n">osThreadId_t</span> <span class="n">Task2_Handle</span><span class="p">;</span>
<span class="k">const</span> <span class="n">osThreadAttr_t</span> <span class="n">Task2_attributes</span> <span class="o">=</span> <span class="p">{</span>
<span class="hll">  <span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"Task2"</span><span class="p">,</span>
</span>  <span class="p">.</span><span class="n">stack_size</span> <span class="o">=</span> <span class="mi">128</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
<span class="hll">  <span class="p">.</span><span class="n">priority</span> <span class="o">=</span> <span class="p">(</span><span class="n">osPriority_t</span><span class="p">)</span> <span class="n">osPriorityNormal</span><span class="p">,</span>
</span><span class="p">};</span>
</code></pre></div>
<p>These two tasks will print out a sequence of character by using the same task <code>CounterTask()</code> which gets a <code>CounterRange_t</code> param from its task function’s parameter:</p>
<div class="admonition caution">
<p class="admonition-title">HAL_Delay()</p>
<p>At the beginning of this lab, <code>HAL_Delay()</code> function is used to simulate a heavy work which is consuming CPU. Scheduler will never put these tasks to the Blocked state.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="kt">void</span> <span class="nf">CounterTask</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
<span class="hll">  <span class="kt">char</span><span class="o">*</span> <span class="n">name</span> <span class="o">=</span> <span class="n">pcTaskGetName</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
</span><span class="hll">  <span class="n">CounterRange_t</span><span class="o">*</span> <span class="n">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">CounterRange_t</span><span class="o">*</span><span class="p">)</span><span class="n">argument</span><span class="p">;</span>
</span>  <span class="n">printf</span><span class="p">(</span><span class="s">"%s: range = %c : %c</span><span class="se">\r\n</span><span class="s">"</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">,</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">);</span>
<span class="hll">  <span class="kt">uint8_t</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">;</span>
</span>  <span class="cm">/* Infinite loop */</span>
  <span class="k">for</span><span class="p">(;;)</span> <span class="p">{</span>
<span class="hll">    <span class="n">printf</span><span class="p">(</span><span class="s">"%s: counter = %c</span><span class="se">\r\n</span><span class="s">"</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">counter</span><span class="o">++</span><span class="p">);</span>
</span><span class="hll">    <span class="k">if</span><span class="p">(</span><span class="n">counter</span> <span class="o">&gt;</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">)</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">;</span>
</span>    <span class="n">HAL_Delay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>In the main function, create two tasks using the <code>CounterTask()</code> function with different delay params. Note that the pointer pointing to the <code>int</code> param is converted to a <code>void*</code> pointer.</p>
<div class="highlight"><pre><span></span><code><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// Hardware init</span>
    <span class="n">HAL_Init</span><span class="p">();</span>
    <span class="n">SystemClock_Config</span><span class="p">();</span>
    <span class="n">MX_GPIO_Init</span><span class="p">();</span>
    <span class="n">MX_USART1_UART_Init</span><span class="p">();</span>

    <span class="c1">// FreeRTOS Init</span>
    <span class="n">osKernelInitialize</span><span class="p">();</span>

    <span class="c1">// Add Tasks</span>
<span class="hll">    <span class="n">Task1Handle</span> <span class="o">=</span> <span class="n">osThreadNew</span><span class="p">(</span><span class="n">CounterTask</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">Task1_CounterRange</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Task1_attributes</span><span class="p">);</span>
</span><span class="hll">    <span class="n">Task2Handle</span> <span class="o">=</span> <span class="n">osThreadNew</span><span class="p">(</span><span class="n">CounterTask</span><span class="p">,</span> <span class="p">(</span><span class="kt">void</span><span class="o">*</span><span class="p">)</span> <span class="o">&amp;</span><span class="n">Task2_CounterRange</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">Task2_attributes</span><span class="p">);</span>
</span>
    <span class="c1">//Start scheduler</span>
    <span class="n">osKernelStart</span><span class="p">();</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="94-build-and-run">9.4. Build and Run<a class="headerlink" href="#94-build-and-run" title="Permanent link">⚓︎</a></h3>
<p>Compile the project and connect the UART1 to PC, and check the result:</p>
<ul>
<li>At startup, tasks print out their name and counter range to confirm the attributes and params</li>
<li>Both tasks run and print their counter values</li>
<li>Because the <code>_write()</code> is implemented as a blocking method (same as a mutex), each task can fully print out its messages.</li>
</ul>
<p>
<figure><img src="lab0_tasks_output.png"/><figcaption>Two tasks are printing</figcaption>
</figure>
</p>
<p>Note that, because two tasks have the same priority, they will be switched at every SysTick interruption (about 1 ms). Both tasks use <code>HAL_Delay()</code> which in fact consume CPU during the waiting time.</p>
<p>
<figure><img src="lab0_tasks_same_priority.png"/><figcaption>Two tasks have the same priority</figcaption>
</figure>
</p>
<h3 id="95-change-priority" style="margin-top:0">9.5. Change Priority<a class="headerlink" href="#95-change-priority" title="Permanent link">⚓︎</a></h3>
<p>Let change one of two task to use <code>osPriorityHigh</code> priority, and see how system works after that modification.</p>
<p>The result is only high priority task can run because higher priory are requesting to use CPU all the time.</p>
<div class="row">
<div class="col">
<div class="highlight"><pre><span></span><code><span class="k">const</span> <span class="n">osThreadAttr_t</span> <span class="n">Task1_attributes</span> <span class="o">=</span> <span class="p">{</span>
<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"Task1"</span><span class="p">,</span>
<span class="p">.</span><span class="n">stack_size</span> <span class="o">=</span> <span class="mi">128</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
<span class="hll"><span class="p">.</span><span class="n">priority</span> <span class="o">=</span> <span class="p">(</span><span class="n">osPriority_t</span><span class="p">)</span> <span class="n">osPriorityHigh</span><span class="p">,</span>
</span><span class="p">}</span>
</code></pre></div>
<p>
<figure style="margin-top:-2em"><img src="lab0_only_task1.png"/><figcaption>Only Task 1 with High Priority is running</figcaption></figure>
</p>
</div>
<div class="col">
<div class="highlight"><pre><span></span><code><span class="k">const</span> <span class="n">osThreadAttr_t</span> <span class="n">Task2_attributes</span> <span class="o">=</span> <span class="p">{</span>
<span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">"Task2"</span><span class="p">,</span>
<span class="p">.</span><span class="n">stack_size</span> <span class="o">=</span> <span class="mi">128</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span>
<span class="hll"><span class="p">.</span><span class="n">priority</span> <span class="o">=</span> <span class="p">(</span><span class="n">osPriority_t</span><span class="p">)</span> <span class="n">osPriorityHigh</span><span class="p">,</span>
</span><span class="p">}</span>
</code></pre></div>
<p>
<figure style="margin-top:-2em"><img src="lab0_only_task2.png"/><figcaption>Only Task 2 with High Priority is running</figcaption></figure>
</p>
</div>
</div>
<div class="admonition info">
<p class="admonition-title">Change priority in runtime</p>
<p>There are two functions to get and set task priority in runtime:</p>
<ul>
<li>
<p>The function <code>osThreadGetPriority()</code> calls <code>uxTaskPriorityGet()</code> or <code>uxTaskPriorityGetFromISR()</code> defined in <code>tasks.c</code> file</p>
</li>
<li>
<p>The function <code>osThreadSetPriority()</code> calls <code>vTaskPrioritySet()</code> defined in <code>tasks.c</code> file. After setting new priority, this function also trigger the task scheduler to re-arrange tasks in the scheduled lists.</p>
</li>
</ul>
<p>Two these functions must be enabled in <strong>Include definitions</strong> settings of FreeRTOS.</p>
</div>
<h3 id="96-use-os-delay">9.6. Use OS Delay<a class="headerlink" href="#96-use-os-delay" title="Permanent link">⚓︎</a></h3>
<p>Keep one task in high priority, how to run both tasks? The key of RTOS scheduler is whenever a task is not working, it can be moved to block state and other task, even in lower priority, can run.</p>
<div class="highlight"><pre><span></span><code><span class="kt">void</span> <span class="nf">CounterTask</span><span class="p">(</span><span class="kt">void</span> <span class="o">*</span><span class="n">argument</span><span class="p">)</span> <span class="p">{</span>
  <span class="kt">char</span><span class="o">*</span> <span class="n">name</span> <span class="o">=</span> <span class="n">pcTaskGetName</span><span class="p">(</span><span class="nb">NULL</span><span class="p">);</span>
  <span class="n">CounterRange_t</span><span class="o">*</span> <span class="n">range</span> <span class="o">=</span> <span class="p">(</span><span class="n">CounterRange_t</span><span class="o">*</span><span class="p">)</span><span class="n">argument</span><span class="p">;</span>
  <span class="n">printf</span><span class="p">(</span><span class="s">"%s: range = %c : %c</span><span class="se">\r\n</span><span class="s">"</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">,</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">);</span>
  <span class="kt">uint8_t</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">;</span>
  <span class="cm">/* Infinite loop */</span>
  <span class="k">for</span><span class="p">(;;)</span> <span class="p">{</span>
    <span class="n">printf</span><span class="p">(</span><span class="s">"%s: counter = %c</span><span class="se">\r\n</span><span class="s">"</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">counter</span><span class="o">++</span><span class="p">);</span>
    <span class="k">if</span><span class="p">(</span><span class="n">counter</span> <span class="o">&gt;</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">end</span><span class="p">)</span> <span class="n">counter</span> <span class="o">=</span> <span class="n">range</span><span class="o">-&gt;</span><span class="n">start</span><span class="p">;</span>
<span class="hll">    <span class="n">osDelay</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>Here is the CPU load while using <code>osDelay()</code>. CPU is only busy when it prints out on UART, and move to IDLE state in which CPU does nothing and waits for SysTick interruption. This is much effective way to lower power consumption.</p>
<p>
<figure><img src="lab0_use_os_delay.png"/><figcaption>CPU is in Idle when both tasks are in delay</figcaption>
</figure>
</p>
<p>There are some more functions related to delay:</p>
<ul>
<li><code>osDelayUntil()</code> which calls to <code>vTaskDelayUntil()</code></li>
<li><code>osAbortDelay()</code> which calls to <code>xTaskAbortDelay()</code></li>
</ul>
<div class="admonition info nt">
<p class="admonition-title"> </p>
<p>The function <code>osDelay()</code> calls to <code>vTaskDelay()</code> function defined in <code>tasks.c</code> file to do below actions:</p>
<ol>
<li>Calls <code>vTaskSuspendAll()</code> to pause the scheduler without disabling interrupts. RTOS tick will be held pending until the scheduler has been resumed.</li>
<li>Remove task from event list (running tasks) and move it to delayed list with given delay value using the function <code>prvAddCurrentTaskToDelayedList()</code></li>
<li>Resume the scheduler using <code>xTaskResumeAll()</code> function</li>
<li>Trigger <code>PendSV</code> interrupt (using <code>portYIELD_WITHIN_API()</code> macro) to switch the context</li>
</ol>
</div>
<h2 id="10-other-tasks-functions" style="margin-top:0">10. Other Tasks functions<a class="headerlink" href="#10-other-tasks-functions" title="Permanent link">⚓︎</a></h2>
<p><strong>Suspend and Resume</strong></p>
<p>A task can be put into Suspended State by calling to <code>osThreadSuspend()</code> which calls to <code>vTaskSuspend()</code> function.
To resume a task, call to <code>osThreadResume()</code> function which actually calls to either <code>vTaskResume()</code> or <code>xTaskResumeFromISR()</code> function.</p>
<p><strong>Terminate a task</strong></p>
<p>Call to <code>osThreadTerminate()</code> function which indeed calls to <code>vTaskDelete()</code> defined in <code>task.c</code> file:</p>
<ol>
<li>Remove the task from the ready list using <code>uxListRemove()</code> and removes the task from waiting on an event tasks list.</li>
<li>In case the task is deleting itself, this function will switch execution to the next task calling function by calling <code>portYIELD_WITHIN_API()</code></li>
</ol>
<p>Memory allocated by the task code is not automatically freed and should be freed before the task is deleted. TCB and its original stack are freed by the IDLE Task.</p>
<p><strong>Task Yield</strong></p>
<p>When a task has done its job, and don’t want to wait for a SysTick interruption, it can yield to scheduler to trigger context switching.</p>
<p>
<figure><img src="task_yield.png"/><figcaption>Task 1 yield</figcaption>
</figure>
</p>
<div data-value="https://www.codeinsideout.com/blog/stm32/free-rtos/tasks/" id="page_url"></div>
<div data-value="blog/stm32/free-rtos/tasks/" id="page_identifier"></div>
<div>
<h2 id="__comments">Comments</h2>
<div id="disqus_thread"></div>
<script>var disqus_config = function () { this.page.url = "https://www.codeinsideout.com/blog/stm32/free-rtos/tasks/", this.page.identifier = "blog/stm32/free-rtos/tasks/" }; window.addEventListener("load", function () { var e = document, i = e.createElement("script"); i.src = "//vuquangtrong-github-io.disqus.com/embed.js", i.setAttribute("data-timestamp", +new Date), (e.head || e.body).appendChild(i) })</script>
</div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" data-md-state="hidden" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path></svg>
            Back to top
          </a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Interrupt" class="md-footer__link md-footer__link--prev" href="../interrupt/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Interrupt
            </div>
</div>
</a>
<a aria-label="Next: Reentrant" class="md-footer__link md-footer__link--next" href="../reentrant/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              Reentrant
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            © 2021 Code Inside Out <div style="display:none"><div>
</div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
<div>
    using
    <a href="https://github.com/vuquangtrong/mkdocs-material-blog">
        MkDocs Material Blog
    </a>
    theme
</div>
</div>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://github.com/vuquangtrong" rel="noopener" target="_blank" title="vuquangtrong">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://facebook.com/trongvq" rel="noopener" target="_blank" title="trongvq">
<svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><path d="m279.14 288 14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://www.linkedin.com/in/vqtrong" rel="noopener" target="_blank" title="vqtrong">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "header.autohide", "search.suggest", "search.highlight"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
<script src="../../../../assets/javascripts/bundle.2b46852b.min.js"></script>
<script src="../../../../assets/view-bigimg.js"></script>
<script src="../../../../assets/extra.js"></script>
</body>
</html>