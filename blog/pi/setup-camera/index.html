
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="Camera module on Raspberry Pi needs to be enabled manually before it can be used by applications. There are some methods to access to the camera with different encoders, but popular drivers include Video For Linux 2, and OMX H264 hardware encoder. This post runs some tests using FFmpeg and PiCamera package to measure the performance of different encoders." name="description"/>
<meta content="embedded systems application programming" name="keywords"/>
<meta content="vqtrong" name="author"/>
<link href="https://www.codeinsideout.com/blog/pi/setup-camera/" rel="canonical"/>
<link href="../../../favicon.png" rel="icon"/>
<meta content="mkdocs-1.2.2, mkdocs-material-7.2.2" name="generator"/>
<title>Raspberry Pi - Setup Camera and test the performance of different video encoders - Code Inside Out</title>
<link href="../../../assets/stylesheets/main.1118c9be.min.css" rel="stylesheet"/>
<link href="../../../assets/stylesheets/palette.ba0d045b.min.css" rel="stylesheet"/>
<meta content="#ffffff" name="theme-color"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Noto+Serif:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font-family:"Noto Serif";--md-code-font-family:"Roboto Mono"}</style>
<link href="../../../assets/view-bigimg.css" rel="stylesheet"/>
<link href="../../../assets/extra.css" rel="stylesheet"/>
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-42618265-2","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script>
<script async="" src="https://www.google-analytics.com/analytics.js"></script>
<meta content="website" property="og:type">
<meta content="Raspberry Pi - Setup Camera and test the performance of different video encoders - Code Inside Out" property="og:title">
<meta content="Camera module on Raspberry Pi needs to be enabled manually before it can be used by applications. There are some methods to access to the camera with different encoders, but popular drivers include Video For Linux 2, and OMX H264 hardware encoder. This post runs some tests using FFmpeg and PiCamera package to measure the performance of different encoders." property="og:description">
<meta content="https://www.codeinsideout.com/blog/pi/setup-camera/" property="og:url">
<meta content="https://www.codeinsideout.com/assets/banner.jpg" property="og:image">
<meta content="Code Inside Out" property="og:site_name">
<meta content="summary" name="twitter:card">
</meta></meta></meta></meta></meta></meta></meta></head>
<body data-md-color-accent="deep-orange" data-md-color-primary="white" data-md-color-scheme="" dir="ltr">
<script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script>
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#1-enable-camera-module">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Code Inside Out" class="md-header__button md-logo" data-md-component="logo" href="../../.." title="Code Inside Out">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="m278.9 511.5-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2 43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6 144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Code Inside Out
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Setup Camera
            
          </span>
</div>
</div>
</div>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"></path></svg>
</button>
</nav>
<div class="md-search__suggest" data-md-component="search-suggest"></div>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-tabs__inner md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../..">
      Home
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link md-tabs__link--active" href="../../">
      Blog
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../projects/">
      Projects
    </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../../tags/">
      Tags
    </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<style>
        .tag-cloud-toc {
            display: none;
        }
        @media screen and (max-width: 76.1875em) {
            .tag-cloud-toc {
                display: block;
            }
        }
    </style>
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Code Inside Out" class="md-nav__button md-logo" data-md-component="logo" href="../../.." title="Code Inside Out">
<svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><path d="m278.9 511.5-61-17.7c-6.4-1.8-10-8.5-8.2-14.9L346.2 8.7c1.8-6.4 8.5-10 14.9-8.2l61 17.7c6.4 1.8 10 8.5 8.2 14.9L293.8 503.3c-1.9 6.4-8.5 10.1-14.9 8.2zm-114-112.2 43.5-46.4c4.6-4.9 4.3-12.7-.8-17.2L117 256l90.6-79.7c5.1-4.5 5.5-12.3.8-17.2l-43.5-46.4c-4.5-4.8-12.1-5.1-17-.5L3.8 247.2c-5.1 4.7-5.1 12.8 0 17.5l144.1 135.1c4.9 4.6 12.5 4.4 17-.5zm327.2.6 144.1-135.1c5.1-4.7 5.1-12.8 0-17.5L492.1 112.1c-4.8-4.5-12.4-4.3-17 .5L431.6 159c-4.6 4.9-4.3 12.7.8 17.2L523 256l-90.6 79.7c-5.1 4.5-5.5 12.3-.8 17.2l43.5 46.4c4.5 4.9 12.1 5.1 17 .6z"></path></svg>
</a>
    Code Inside Out
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../..">
        Home
      </a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../" style="margin: initial; padding: initial; pointer-events: initial">
        
          Blog
        </a>
</label>
<nav aria-label="Blog" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../" style="margin: initial; padding: initial; pointer-events: initial">
          
            Blog
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1" id="__nav_2_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../stm32/" style="margin: initial; padding: initial; pointer-events: initial">
        
          STM32
        </a>
</label>
<nav aria-label="STM32" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_1">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../stm32/" style="margin: initial; padding: initial; pointer-events: initial">
          
            STM32
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/intro/">
        Introduction
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/prepare/">
        Preparation
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/tools/">
        Toolchain
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/docs/">
        Documents
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/clock/">
        Clock Tree
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/interrupt/">
        Interrupt
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/semihosting/">
        Semihosting
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/gpio/">
        GPIO
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/dma/">
        DMA
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/swv/">
        SWV
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/add-swo/">
        Add SWO
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/uart/">
        UART
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/uart-redirection/">
        UART Redirection
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/timer/">
        Timers
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/sensor-us-100/">
        US-100 Sensor
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/adc/">
        ADC
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/i2c-spi/">
        I2C - SPI
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/oled-ssd1306/">
        SSD1306 OLED
      </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_1_19" id="__nav_2_1_19" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_1_19">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../stm32/free-rtos/overview/" style="margin: initial; padding: initial; pointer-events: initial">
        
          FreeRTOS
        </a>
</label>
<nav aria-label="FreeRTOS" class="md-nav" data-md-level="3">
<label class="md-nav__title" for="__nav_2_1_19">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../stm32/free-rtos/overview/" style="margin: initial; padding: initial; pointer-events: initial">
          
            FreeRTOS
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/free-rtos/systick/">
        SysTick &amp; Delay
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/free-rtos/memory/">
        Memory
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/free-rtos/interrupt/">
        Interrupt
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/free-rtos/tasks/">
        Tasks
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/free-rtos/reentrant/">
        Reentrant
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/j-link-rtt/">
        J-Link RTT
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/j-link-sysview/">
        J-Link SysView
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../stm32/notes/">
        Notes
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_2" id="__nav_2_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../" style="margin: initial; padding: initial; pointer-events: initial">
        
          Raspberry Pi
        </a>
</label>
<nav aria-label="Raspberry Pi" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_2">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../" style="margin: initial; padding: initial; pointer-events: initial">
          
            Raspberry Pi
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../headless-mode/">
        Headless mode
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../compile-ffmpeg/">
        Compile FFmpeg
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../resource-usage/">
        Resource usage
      </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link md-nav__link--active" href="./" style="margin: initial; padding: initial; pointer-events: initial">
          
            Setup Camera
          </a>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
        Setup Camera
      </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-enable-camera-module">
    1. Enable Camera module
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-increase-gpu-memory">
    2. Increase GPU memory
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-test-camera">
    3. Test Camera
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-video-for-linux-2---v4l2">
    4. Video for Linux 2 - V4L2
  </a>
<nav aria-label="4. Video for Linux 2 - V4L2" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#41-list-devices">
    4.1. List devices
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#42-driver-info">
    4.2. Driver info
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#43-supported-formats">
    4.3. Supported formats
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#44-capture-jpeg-image">
    4.4. Capture JPEG Image
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#45-record-h264-video">
    4.5. Record H264 Video
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-ffmpeg">
    5. FFmpeg
  </a>
<nav aria-label="5. FFmpeg" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#51-encoders">
    5.1. Encoders
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#52-performance">
    5.2. Performance
  </a>
<nav aria-label="5.2. Performance" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#521-raw-to-mjpeg-avi">
    5.2.1. Raw to MJPEG (.avi)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#522-raw-to-h264_omx-8mbps-mp4">
    5.2.2. Raw to H264_OMX @8Mbps (.mp4)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#523-raw-to-h264_v4l2m2m-8mbps-mp4">
    5.2.3. Raw to H264_V4L2M2M @8Mbps (.mp4)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#524-v4l2-mjpeg-direct-copy-avi">
    5.2.4. V4L2 MJPEG direct copy (.avi)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#525-v4l2-h264-direct-copy-mp4">
    5.2.5. V4L2 H264 direct copy (.mp4)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#526-conclusion">
    5.2.6. Conclusion
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-install-picamera">
    6. Install picamera
  </a>
<nav aria-label="6. Install picamera" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#61-picamera-h264-h264">
    6.1. Picamera H264 (.h264)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#62-picamera-h264-h264-with-text-overlay">
    6.2. Picamera H264 (.h264) with Text overlay
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../stream-ffmpeg-hls-dash/">
        HLS/DASH Streaming
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../stream-picamera-mjpeg/">
        MJPEG streaming
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../stream-picamera-h264/">
        H264 streaming
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../backup-sdcard/">
        Backup SDCard
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../check-camera-i2c/">
        Diagnostic Camera
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../ubuntu/">
        Ubuntu
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../notes/">
        Notes
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_3" id="__nav_2_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../c-cpp/" style="margin: initial; padding: initial; pointer-events: initial">
        
          C/C++
        </a>
</label>
<nav aria-label="C/C++" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_3">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../c-cpp/" style="margin: initial; padding: initial; pointer-events: initial">
          
            C/C++
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../c-cpp/notes/">
        Notes
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_4" id="__nav_2_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../lidar/" style="margin: initial; padding: initial; pointer-events: initial">
        
          Lidar
        </a>
</label>
<nav aria-label="Lidar" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_4">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../lidar/" style="margin: initial; padding: initial; pointer-events: initial">
          
            Lidar
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../lidar/livox-sdk/">
        Livox SDK
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_5" id="__nav_2_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../linux/" style="margin: initial; padding: initial; pointer-events: initial">
        
          Linux
        </a>
</label>
<nav aria-label="Linux" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_5">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../linux/" style="margin: initial; padding: initial; pointer-events: initial">
          
            Linux
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../linux/byobu/">
        Byobu
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../linux/dual-boot/">
        Dual Boot
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../linux/samba/">
        Samba
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../linux/tweaks/">
        Tweaks
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_6" id="__nav_2_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_6">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../ros/" style="margin: initial; padding: initial; pointer-events: initial">
        
          ROS
        </a>
</label>
<nav aria-label="ROS" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_6">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../ros/" style="margin: initial; padding: initial; pointer-events: initial">
          
            ROS
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../ros/tutorial-beginner/">
        Tutorial for Beginners
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_7" id="__nav_2_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_7">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../setup-blog/" style="margin: initial; padding: initial; pointer-events: initial">
        
          Setup blog
        </a>
</label>
<nav aria-label="Setup blog" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_7">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../setup-blog/" style="margin: initial; padding: initial; pointer-events: initial">
          
            Setup blog
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-blog/markdown-syntax/">
        Markdown syntax
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-blog/mkdocs-plugins/">
        MkDocs plugins
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-blog/customize-theme/">
        Customize theme
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-blog/print-to-pdf/">
        Print to PDF
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../setup-blog/fix-ajax-issue/">
        Fix AJAX issue
      </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_8" id="__nav_2_8" type="checkbox"/>
<label class="md-nav__link" for="__nav_2_8">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../virtual-machine/" style="margin: initial; padding: initial; pointer-events: initial">
        
          Virtual machine
        </a>
</label>
<nav aria-label="Virtual machine" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_2_8">
<span class="md-nav__icon md-icon"></span>
<a class="md-nav__link" href="../../virtual-machine/" style="margin: initial; padding: initial; pointer-events: initial">
          
            Virtual machine
          </a>
</label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../virtual-machine/docker/">
        Docker
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../virtual-machine/hyper-v/">
        Hyper-V
      </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../projects/">
        Projects
      </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../../tags/">
        Tags
      </a>
</li>
</ul>
</nav>
<div class="tag-cloud-nav">
<p class="md-nav" style="margin-bottom: 0.5em;">
<label class="md-nav__title">Tag cloud</label>
</p>
<div class="tag-cloud-content">
<a class="tag" href="https://www.codeinsideout.com/tags/#swv">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">swv</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#joystick">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">joystick</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stm32">
<span class="tag-name" style="
          font-size:1.7000000000000002rem;
          color:DarkSlateBlue;
        ">stm32</span>
<!--<sup class="tag-count">24</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pulse">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">pulse</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ffmpeg">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkBlue;
        ">ffmpeg</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#hls">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">hls</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#systick">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">systick</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#board">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">board</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#lidar">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkOliveGreen;
        ">lidar</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#raspberry-pi">
<span class="tag-name" style="
          font-size:1.05rem;
          color:DarkMagenta;
        ">raspberry-pi</span>
<!--<sup class="tag-count">11</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#reentrant">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">reentrant</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#interrupt">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkTurquoise;
        ">interrupt</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#dash">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">dash</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#virtual">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">virtual</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#hyper-v">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">hyper-v</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#redirect">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">redirect</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#performance">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">performance</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#material">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">material</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#semihosting">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">semihosting</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#usart">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">usart</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sensor">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">sensor</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#timer">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">timer</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#virtual-machine">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkSlateBlue;
        ">virtual-machine</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pwm">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">pwm</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#docs">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">docs</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#rtos">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkBlue;
        ">rtos</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mjpeg">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">mjpeg</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ros">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkMagenta;
        ">ros</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#docker">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">docker</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#debug">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkBlue;
        ">debug</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sysview">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">sysview</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#capture">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">capture</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sharing">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">sharing</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#toolchain">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">toolchain</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#css">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">css</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#livox">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">livox</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stream">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkTurquoise;
        ">stream</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#clock">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">clock</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#headless">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">headless</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#rtt">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkGreen;
        ">rtt</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#samba">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">samba</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#javascript">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkCyan;
        ">javascript</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#i2c">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkOliveGreen;
        ">i2c</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#jinja">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">jinja</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#arm">
<span class="tag-name" style="
          font-size:1.6rem;
          color:DarkTurquoise;
        ">arm</span>
<!--<sup class="tag-count">22</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#uart">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkMagenta;
        ">uart</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ajax">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">ajax</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#v4l2">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">v4l2</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#gps">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkCyan;
        ">gps</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#adc">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">adc</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#markdown">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">markdown</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#linux">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkSlateBlue;
        ">linux</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#html">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">html</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#notes">
<span class="tag-name" style="
          font-size:0.7rem;
          color:DarkSlateGray;
        ">notes</span>
<!--<sup class="tag-count">4</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pi">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">pi</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ssd1306">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">ssd1306</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#bash">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">bash</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#c++">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">c++</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sdcard">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">sdcard</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#h264">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">h264</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mkdocs">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkViolet;
        ">mkdocs</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#container">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">container</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#picamera">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkGoldenrod;
        ">picamera</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#python">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkRed;
        ">python</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#dma">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkOrchid;
        ">dma</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#c">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkCyan;
        ">c</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#camera">
<span class="tag-name" style="
          font-size:0.8rem;
          color:DarkViolet;
        ">camera</span>
<!--<sup class="tag-count">6</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mapping">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">mapping</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pdf">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">pdf</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#spi">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">spi</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#distance">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">distance</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#gpio">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">gpio</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#memory">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkBlue;
        ">memory</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#oled">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">oled</span>
<!--<sup class="tag-count">1</sup>-->
</a>
</div>
</div>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-enable-camera-module">
    1. Enable Camera module
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-increase-gpu-memory">
    2. Increase GPU memory
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-test-camera">
    3. Test Camera
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-video-for-linux-2---v4l2">
    4. Video for Linux 2 - V4L2
  </a>
<nav aria-label="4. Video for Linux 2 - V4L2" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#41-list-devices">
    4.1. List devices
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#42-driver-info">
    4.2. Driver info
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#43-supported-formats">
    4.3. Supported formats
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#44-capture-jpeg-image">
    4.4. Capture JPEG Image
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#45-record-h264-video">
    4.5. Record H264 Video
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-ffmpeg">
    5. FFmpeg
  </a>
<nav aria-label="5. FFmpeg" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#51-encoders">
    5.1. Encoders
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#52-performance">
    5.2. Performance
  </a>
<nav aria-label="5.2. Performance" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#521-raw-to-mjpeg-avi">
    5.2.1. Raw to MJPEG (.avi)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#522-raw-to-h264_omx-8mbps-mp4">
    5.2.2. Raw to H264_OMX @8Mbps (.mp4)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#523-raw-to-h264_v4l2m2m-8mbps-mp4">
    5.2.3. Raw to H264_V4L2M2M @8Mbps (.mp4)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#524-v4l2-mjpeg-direct-copy-avi">
    5.2.4. V4L2 MJPEG direct copy (.avi)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#525-v4l2-h264-direct-copy-mp4">
    5.2.5. V4L2 H264 direct copy (.mp4)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#526-conclusion">
    5.2.6. Conclusion
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-install-picamera">
    6. Install picamera
  </a>
<nav aria-label="6. Install picamera" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#61-picamera-h264-h264">
    6.1. Picamera H264 (.h264)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#62-picamera-h264-h264-with-text-overlay">
    6.2. Picamera H264 (.h264) with Text overlay
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
<div class="tag-cloud-toc">
<p class="md-nav" style="margin-bottom: 0.5em;">
<label class="md-nav__title">Tag cloud</label>
</p>
<div class="tag-cloud-content">
<a class="tag" href="https://www.codeinsideout.com/tags/#arm">
<span class="tag-name" style="
          font-size:1.6rem;
          color:DarkOrchid;
        ">arm</span>
<!--<sup class="tag-count">22</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#docker">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">docker</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#camera">
<span class="tag-name" style="
          font-size:0.8rem;
          color:DarkOrchid;
        ">camera</span>
<!--<sup class="tag-count">6</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#adc">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">adc</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#python">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkOliveGreen;
        ">python</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#hls">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">hls</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#distance">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">distance</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#toolchain">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">toolchain</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#rtt">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkSlateBlue;
        ">rtt</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pwm">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">pwm</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#c++">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">c++</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#docs">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">docs</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#oled">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">oled</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#container">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">container</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#debug">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkGreen;
        ">debug</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#hyper-v">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkCyan;
        ">hyper-v</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#linux">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkGreen;
        ">linux</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pi">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">pi</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#c">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">c</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#h264">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">h264</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sdcard">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">sdcard</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#memory">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkOliveGreen;
        ">memory</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#dma">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkViolet;
        ">dma</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#dash">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">dash</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#spi">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">spi</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#gpio">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">gpio</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#lidar">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkSlateGray;
        ">lidar</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#interrupt">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkOrchid;
        ">interrupt</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sensor">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">sensor</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#samba">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">samba</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#css">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">css</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#timer">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">timer</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#board">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">board</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#headless">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">headless</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#performance">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">performance</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#virtual-machine">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkViolet;
        ">virtual-machine</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#html">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">html</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#notes">
<span class="tag-name" style="
          font-size:0.7rem;
          color:DarkGoldenrod;
        ">notes</span>
<!--<sup class="tag-count">4</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mkdocs">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkRed;
        ">mkdocs</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#jinja">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">jinja</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#capture">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">capture</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ros">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkViolet;
        ">ros</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#reentrant">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">reentrant</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pdf">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">pdf</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#swv">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">swv</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#clock">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOliveGreen;
        ">clock</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sharing">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkCyan;
        ">sharing</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#usart">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">usart</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#markdown">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">markdown</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#javascript">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkTurquoise;
        ">javascript</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#pulse">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">pulse</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#redirect">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateGray;
        ">redirect</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#semihosting">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">semihosting</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ajax">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">ajax</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#sysview">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkRed;
        ">sysview</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mjpeg">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGoldenrod;
        ">mjpeg</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ssd1306">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">ssd1306</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stm32">
<span class="tag-name" style="
          font-size:1.7000000000000002rem;
          color:DarkBlue;
        ">stm32</span>
<!--<sup class="tag-count">24</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#i2c">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkCyan;
        ">i2c</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#material">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkOrchid;
        ">material</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#raspberry-pi">
<span class="tag-name" style="
          font-size:1.05rem;
          color:DarkRed;
        ">raspberry-pi</span>
<!--<sup class="tag-count">11</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#mapping">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkGreen;
        ">mapping</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#rtos">
<span class="tag-name" style="
          font-size:0.75rem;
          color:DarkOliveGreen;
        ">rtos</span>
<!--<sup class="tag-count">5</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#virtual">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkBlue;
        ">virtual</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#uart">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkMagenta;
        ">uart</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#joystick">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">joystick</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#v4l2">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkMagenta;
        ">v4l2</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#stream">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkGreen;
        ">stream</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#picamera">
<span class="tag-name" style="
          font-size:0.65rem;
          color:DarkGoldenrod;
        ">picamera</span>
<!--<sup class="tag-count">3</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#gps">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">gps</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#bash">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkSlateBlue;
        ">bash</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#systick">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkViolet;
        ">systick</span>
<!--<sup class="tag-count">1</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ffmpeg">
<span class="tag-name" style="
          font-size:0.6rem;
          color:DarkGreen;
        ">ffmpeg</span>
<!--<sup class="tag-count">2</sup>-->
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#livox">
<span class="tag-name" style="
          font-size:0.55rem;
          color:DarkTurquoise;
        ">livox</span>
<!--<sup class="tag-count">1</sup>-->
</a>
</div>
</div>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<style>
            .md-typeset .cover {
                margin-bottom: 1em;
            }
            @media print {
                .md-typeset .cover {
                    height: 100vh;
                    display: flex;
                    flex-direction: column;
                    justify-content: center;
                }
            }
        </style>
<div class="cover">
<h1 class="page-title">Raspberry Pi - Setup Camera and test the performance of different video encoders</h1>
<p class="page-description">Camera module on Raspberry Pi needs to be enabled manually before it can be used by applications. There are some methods to access to the camera with different encoders, but popular drivers include Video For Linux 2, and OMX H264 hardware encoder. This post runs some tests using FFmpeg and PiCamera package to measure the performance of different encoders.</p>
<p class="page-tags">
<a class="tag" href="https://www.codeinsideout.com/tags/#raspberry-pi">
<span class="tag-name">
                        #raspberry-pi
                    </span>
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#camera">
<span class="tag-name">
                        #camera
                    </span>
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#v4l2">
<span class="tag-name">
                        #v4l2
                    </span>
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#ffmpeg">
<span class="tag-name">
                        #ffmpeg
                    </span>
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#python">
<span class="tag-name">
                        #python
                    </span>
</a>
<a class="tag" href="https://www.codeinsideout.com/tags/#picamera">
<span class="tag-name">
                        #picamera
                    </span>
</a>
</p>
<p class="md-source-date">
<hr style="margin-bottom: .5em;"/>
<small>
                            Last update:
                            <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-iso_datetime">2021-08-04 17:31:07</span>
</small>
</p>
</div>
<style>
            .md-typeset .toc {
                display: none;
            }
            .md-typeset .toc label {
                display: none;
            }
            .md-typeset .toc .md-nav {
                font-size: unset;
                line-height: 1.6;
            }
            .md-typeset .toc .md-nav--secondary {
                margin-left: -2em;
            }
            .md-typeset .toc .md-nav__list {
                margin: 0;
            }
            .md-typeset .toc ul {
                list-style: none;
            }
            @media print {
                .md-typeset .toc {
                    display: block;
                    page-break-after: always;
                }
                .md-typeset .toc .md-nav__link {
                    color: var(--md-typeset-a-color);
                }
                .md-typeset .toc .md-nav__link.md-nav__link--active {
                    font-weight: unset;
                }
            }
        </style>
<div class="toc">
<h2>Table of Content</h2>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#1-enable-camera-module">
    1. Enable Camera module
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#2-increase-gpu-memory">
    2. Increase GPU memory
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#3-test-camera">
    3. Test Camera
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#4-video-for-linux-2---v4l2">
    4. Video for Linux 2 - V4L2
  </a>
<nav aria-label="4. Video for Linux 2 - V4L2" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#41-list-devices">
    4.1. List devices
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#42-driver-info">
    4.2. Driver info
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#43-supported-formats">
    4.3. Supported formats
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#44-capture-jpeg-image">
    4.4. Capture JPEG Image
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#45-record-h264-video">
    4.5. Record H264 Video
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#5-ffmpeg">
    5. FFmpeg
  </a>
<nav aria-label="5. FFmpeg" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#51-encoders">
    5.1. Encoders
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#52-performance">
    5.2. Performance
  </a>
<nav aria-label="5.2. Performance" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#521-raw-to-mjpeg-avi">
    5.2.1. Raw to MJPEG (.avi)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#522-raw-to-h264_omx-8mbps-mp4">
    5.2.2. Raw to H264_OMX @8Mbps (.mp4)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#523-raw-to-h264_v4l2m2m-8mbps-mp4">
    5.2.3. Raw to H264_V4L2M2M @8Mbps (.mp4)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#524-v4l2-mjpeg-direct-copy-avi">
    5.2.4. V4L2 MJPEG direct copy (.avi)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#525-v4l2-h264-direct-copy-mp4">
    5.2.5. V4L2 H264 direct copy (.mp4)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#526-conclusion">
    5.2.6. Conclusion
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#6-install-picamera">
    6. Install picamera
  </a>
<nav aria-label="6. Install picamera" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#61-picamera-h264-h264">
    6.1. Picamera H264 (.h264)
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#62-picamera-h264-h264-with-text-overlay">
    6.2. Picamera H264 (.h264) with Text overlay
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div><div class="btn-actions screen-only"><p><a class="md-button" href="..\..\..\pdfs\blog\pi\setup-camera\pi__Setup_Camera.pdf"><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M5 20h14v-2H5m14-9h-4V3H9v6H5l7 7 7-7z"></path></svg></span>PDF</a></p></div>
<p>
<figure class="w40"><img src="pi_camera_v2.1.png"/><figcaption>RaspberryPi Camera Module</figcaption></figure>
</p>
<div class="admonition info nt">
<p class="admonition-title"> </p>
<p>This tutorial is for setting up the official Raspberry Pi Camera module which is attached with a CSI cable. Other types of USB Camera should work on Pi out-of-the-box.</p>
</div>
<h2 id="1-enable-camera-module">1. Enable Camera module<a class="headerlink" href="#1-enable-camera-module" title="Permanent link">⚓︎</a></h2>
<p>Run <code>raspi-config</code> configuration tool:</p>
<div class="highlight"><pre><span></span><code>sudo raspi-config
</code></pre></div>
<p>then select <strong>Interfacing Options</strong> → <strong>Camera</strong> → <strong>Yes</strong>.</p>
<p>This method will automatically set <code>start_x=1</code> in <code>/boot/config.txt</code> file.</p>
<div class="admonition info nt">
<p class="admonition-title"> </p>
<p><strong>raspi-config</strong> is a Raspberry Pi configuration command-line tool, to enable or disable some features in Pi OS. This tool requires root permission, therefore, it must be run with the super user right using <code>sudo</code>.</p>
<p>
<figure><img src="raspi_config.png"/><figcaption>User interface of <code>raspi-config</code></figcaption>
</figure>
</p>
</div>
<div class="np"></div>
<h2 id="2-increase-gpu-memory">2. Increase GPU memory<a class="headerlink" href="#2-increase-gpu-memory" title="Permanent link">⚓︎</a></h2>
<p>Some video encoders need a big buffer to process video encoding or decoding. To increase the memory reserved for video processor, in the <code>raspi-config</code> configuration tool, go to <strong>Performance Options</strong> → <strong>GPU Memory</strong> then fill in <mark><strong><em>256</em></strong></mark> and select <strong>OK</strong>.</p>
<p>This method does the same thing with setting up <code>gpu_mem=256</code> in <code>/boot/config.txt</code>.</p>
<h2 id="3-test-camera">3. Test Camera<a class="headerlink" href="#3-test-camera" title="Permanent link">⚓︎</a></h2>
<p>Detect the camera connection by running the checking tool:</p>
<div class="highlight"><pre><span></span><code>vcgencmd get_camera
</code></pre></div>
<p>which should print out <code>supported=1 detected=1</code> telling that the camera is supported and connected.</p>
<div class="admonition info nt">
<p class="admonition-title"> </p>
<p><strong>vcgencmd</strong> is a command line utility that can get various pieces of information from the VideoCore GPU on the Raspberry Pi. Check more detail in <a href="https://www.raspberrypi.org/documentation/raspbian/applications/vcgencmd.md">Raspberry Pi/vcgencmd</a></p>
</div>
<p><a href="https://www.raspberrypi.org/documentation/usage/camera/raspicam/">Raspicam commands</a> has a set of tools to work with the camera module: <code>raspistill</code>, <code>raspivid</code>, and <code>raspiyuv</code>.</p>
<ul>
<li>
<p>Capture an image: <code>raspistill -o cam.jpg</code></p>
</li>
<li>
<p>Record an video: <code>raspivid -o vid.h264</code></p>
</li>
</ul>
<h2 id="4-video-for-linux-2---v4l2">4. Video for Linux 2 - V4L2<a class="headerlink" href="#4-video-for-linux-2---v4l2" title="Permanent link">⚓︎</a></h2>
<p>Under Linux, the standard APIs for cameras (including webcams) is <code>V4L</code> (Video for Linux), and a number of applications have been written that support any camera with a V4L driver. An independent developer has now written an user space V4L driver for the Raspberry Pi camera but it is closed sourced, and can be a little slow because it runs as a user program rather than a kernel driver.</p>
<p>Recognizing that a V4L driver is needed, the Raspberry Pi Foundation reported that they were working with Broadcom to develop an official kernel V4L driver. As a kernel driver, it should be faster than the user space driver.</p>
<p>Finally, V4L2 was released under the name <code>bcm2835-v4l2</code> which is included Raspberry Pi OS by default. Use <code>v4l2-ctl</code> utility tool to capture from the camera.</p>
<div class="np"></div>
<h3 id="41-list-devices">4.1. List devices<a class="headerlink" href="#41-list-devices" title="Permanent link">⚓︎</a></h3>
<div class="highlight"><pre><span></span><code>v4l2-ctl --list-devices
</code></pre></div>
<div class="log">
<div class="highlight"><pre><span></span><code><span class="go">bcm2835-codec-decode (platform:bcm2835-codec):</span>
<span class="go">        /dev/video10</span>
<span class="go">        /dev/video11</span>
<span class="go">        /dev/video12</span>

<span class="go">bcm2835-isp (platform:bcm2835-isp):</span>
<span class="go">        /dev/video13</span>
<span class="go">        /dev/video14</span>
<span class="go">        /dev/video15</span>
<span class="go">        /dev/video16</span>

<span class="go">mmal service 16.1 (platform:bcm2835-v4l2):</span>
<span class="go">        /dev/video0</span>
</code></pre></div>
</div>
<h3 id="42-driver-info">4.2. Driver info<a class="headerlink" href="#42-driver-info" title="Permanent link">⚓︎</a></h3>
<div class="highlight"><pre><span></span><code>v4l2-ctl -d /dev/video0 --all
</code></pre></div>
<!--
<div class="highlight"><pre><span></span><code><span class="go">Driver Info:</span>
<span class="go">        Driver name      : bm2835 mmal</span>
<span class="go">        Card type        : mmal service 16.1</span>
<span class="go">        Bus info         : platform:bcm2835-v4l2</span>
<span class="go">        Driver version   : 5.4.79</span>
<span class="go">        Capabilities     : 0x85200005</span>
<span class="go">                Video Capture</span>
<span class="go">                Video Overlay</span>
<span class="go">                Read/Write</span>
<span class="go">                Streaming</span>
<span class="go">                Extended Pix Format</span>
<span class="go">                Device Capabilities</span>
<span class="go">        Device Caps      : 0x05200005</span>
<span class="go">                Video Capture</span>
<span class="go">                Video Overlay</span>
<span class="go">                Read/Write</span>
<span class="go">                Streaming</span>
<span class="go">                Extended Pix Format</span>
<span class="go">Priority: 2</span>
<span class="go">Video input : 0 (Camera 0: ok)</span>
<span class="go">Format Video Capture:</span>
<span class="go">        Width/Height      : 1024/768</span>
<span class="go">        Pixel Format      : &#39;JPEG&#39; (JFIF JPEG)</span>
<span class="go">        Field             : None</span>
<span class="go">        Bytes per Line    : 0</span>
<span class="go">        Size Image        : 786432</span>
<span class="go">        Colorspace        : JPEG</span>
<span class="go">        Transfer Function : Default (maps to sRGB)</span>
<span class="go">        YCbCr/HSV Encoding: Default (maps to ITU-R 601)</span>
<span class="go">        Quantization      : Default (maps to Full Range)</span>
<span class="go">        Flags             :</span>
<span class="go">Format Video Overlay:</span>
<span class="go">        Left/Top    : 150/50</span>
<span class="go">        Width/Height: 1024/768</span>
<span class="go">        Field       : None</span>
<span class="go">        Chroma Key  : 0x00000000</span>
<span class="go">        Global Alpha: 0xff</span>
<span class="go">        Clip Count  : 0</span>
<span class="go">        Clip Bitmap : No</span>
<span class="go">Framebuffer Format:</span>
<span class="go">        Capability    : Extern Overlay</span>
<span class="go">                        Global Alpha</span>
<span class="go">        Flags         : Overlay Matches Capture/Output Size</span>
<span class="go">        Width         : 1024</span>
<span class="go">        Height        : 768</span>
<span class="go">        Pixel Format  : &#39;YU12&#39;</span>
<span class="go">Streaming Parameters Video Capture:</span>
<span class="go">        Capabilities     : timeperframe</span>
<span class="go">        Frames per second: 30.000 (30000/1000)</span>
<span class="go">        Read buffers     : 1</span>

<span class="go">User Controls</span>

<span class="go">                     brightness 0x00980900 (int)    : min=0 max=100 step=1 default=50 value=50 flags=slider</span>
<span class="go">                       contrast 0x00980901 (int)    : min=-100 max=100 step=1 default=0 value=0 flags=slider</span>
<span class="go">                     saturation 0x00980902 (int)    : min=-100 max=100 step=1 default=0 value=0 flags=slider</span>
<span class="go">                    red_balance 0x0098090e (int)    : min=1 max=7999 step=1 default=1000 value=1000 flags=slider</span>
<span class="go">                   blue_balance 0x0098090f (int)    : min=1 max=7999 step=1 default=1000 value=1000 flags=slider</span>
<span class="go">                horizontal_flip 0x00980914 (bool)   : default=0 value=0</span>
<span class="go">                  vertical_flip 0x00980915 (bool)   : default=0 value=0</span>
<span class="go">           power_line_frequency 0x00980918 (menu)   : min=0 max=3 default=1 value=1</span>
<span class="go">                      sharpness 0x0098091b (int)    : min=-100 max=100 step=1 default=0 value=0 flags=slider</span>
<span class="go">                  color_effects 0x0098091f (menu)   : min=0 max=15 default=0 value=0</span>
<span class="go">                         rotate 0x00980922 (int)    : min=0 max=360 step=90 default=0 value=0 flags=modify-layout</span>
<span class="go">             color_effects_cbcr 0x0098092a (int)    : min=0 max=65535 step=1 default=32896 value=32896</span>

<span class="go">Codec Controls</span>

<span class="go">             video_bitrate_mode 0x009909ce (menu)   : min=0 max=1 default=0 value=0 flags=update</span>
<span class="go">                  video_bitrate 0x009909cf (int)    : min=25000 max=25000000 step=25000 default=10000000 value=10000000</span>
<span class="go">         repeat_sequence_header 0x009909e2 (bool)   : default=0 value=0</span>
<span class="go">            h264_i_frame_period 0x00990a66 (int)    : min=0 max=2147483647 step=1 default=60 value=60</span>
<span class="go">                     h264_level 0x00990a67 (menu)   : min=0 max=11 default=11 value=11</span>
<span class="go">                   h264_profile 0x00990a6b (menu)   : min=0 max=4 default=4 value=4</span>

<span class="go">Camera Controls</span>

<span class="go">                  auto_exposure 0x009a0901 (menu)   : min=0 max=3 default=0 value=0</span>
<span class="go">         exposure_time_absolute 0x009a0902 (int)    : min=1 max=10000 step=1 default=1000 value=1000</span>
<span class="go">     exposure_dynamic_framerate 0x009a0903 (bool)   : default=0 value=0</span>
<span class="go">             auto_exposure_bias 0x009a0913 (intmenu): min=0 max=24 default=12 value=12</span>
<span class="go">      white_balance_auto_preset 0x009a0914 (menu)   : min=0 max=10 default=1 value=1</span>
<span class="go">            image_stabilization 0x009a0916 (bool)   : default=0 value=0</span>
<span class="go">                iso_sensitivity 0x009a0917 (intmenu): min=0 max=4 default=0 value=0</span>
<span class="go">           iso_sensitivity_auto 0x009a0918 (menu)   : min=0 max=1 default=1 value=1</span>
<span class="go">         exposure_metering_mode 0x009a0919 (menu)   : min=0 max=2 default=0 value=0</span>
<span class="go">                     scene_mode 0x009a091a (menu)   : min=0 max=13 default=0 value=0</span>

<span class="go">JPEG Compression Controls</span>

<span class="go">            compression_quality 0x009d0903 (int)    : min=1 max=100 step=1 default=30 value=30</span>
</code></pre></div>
-->
<div class="log">
<div class="highlight"><pre><span></span><code><span class="go">Driver Info:</span>
<span class="go">    Driver name      : bm2835 mmal</span>
<span class="go">    Card type        : mmal service 16.1</span>
<span class="go">    Bus info         : platform:bcm2835-v4l2</span>
<span class="go">    Driver version   : 5.4.79</span>
<span class="go">    Capabilities     : 0x85200005</span>
<span class="go">            Video Capture</span>
<span class="go">            Video Overlay</span>
<span class="go">            Read/Write</span>
<span class="go">            Streaming</span>
<span class="go">    ...</span>
</code></pre></div>
</div>
<h3 id="43-supported-formats">4.3. Supported formats<a class="headerlink" href="#43-supported-formats" title="Permanent link">⚓︎</a></h3>
<div class="highlight"><pre><span></span><code>v4l2-ctl --list-formats
</code></pre></div>
<div class="log">
<div class="highlight"><pre><span></span><code><span class="go">ioctl: VIDIOC_ENUM_FMT</span>
<span class="go">        Type: Video Capture</span>

<span class="go">        [0]: 'YU12' (Planar YUV 4:2:0)</span>
<span class="go">        [1]: 'YUYV' (YUYV 4:2:2)</span>
<span class="hll"><span class="go">        [2]: 'RGB3' (24-bit RGB 8-8-8)</span>
</span><span class="hll"><span class="go">        [3]: 'JPEG' (JFIF JPEG, compressed)</span>
</span><span class="hll"><span class="go">        [4]: 'H264' (H.264, compressed)</span>
</span><span class="hll"><span class="go">        [5]: 'MJPG' (Motion-JPEG, compressed)</span>
</span><span class="go">        [6]: 'YVYU' (YVYU 4:2:2)</span>
<span class="go">        [7]: 'VYUY' (VYUY 4:2:2)</span>
<span class="go">        [8]: 'UYVY' (UYVY 4:2:2)</span>
<span class="go">        [9]: 'NV12' (Y/CbCr 4:2:0)</span>
<span class="go">        [10]: 'BGR3' (24-bit BGR 8-8-8)</span>
<span class="go">        [11]: 'YV12' (Planar YVU 4:2:0)</span>
<span class="go">        [12]: 'NV21' (Y/CrCb 4:2:0)</span>
<span class="go">        [13]: 'RX24' (32-bit XBGR 8-8-8-8)</span>
</code></pre></div>
</div>
<p>Please take a note for <code>RGB3</code>, <code>JPEG</code>, <code>H264</code>, and <code>MJPEG</code>, which can be used in OpenCV, or streaming directly.</p>
<h3 id="44-capture-jpeg-image">4.4. Capture JPEG Image<a class="headerlink" href="#44-capture-jpeg-image" title="Permanent link">⚓︎</a></h3>
<div class="highlight"><pre><span></span><code>v4l2-ctl --set-fmt-video<span class="o">=</span><span class="nv">width</span><span class="o">=</span><span class="m">2592</span>,height<span class="o">=</span><span class="m">1944</span>,pixelformat<span class="o">=</span><span class="m">3</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
v4l2-ctl --stream-mmap<span class="o">=</span><span class="m">3</span> --stream-count<span class="o">=</span><span class="m">1</span> --stream-to<span class="o">=</span>somefile.jpg
</code></pre></div>
<h3 id="45-record-h264-video">4.5. Record H264 Video<a class="headerlink" href="#45-record-h264-video" title="Permanent link">⚓︎</a></h3>
<div class="admonition warning nt">
<p class="admonition-title"> </p>
<p>Note the value <em>height=<strong>1088</strong></em>, not 1080.</p>
</div>
<div class="highlight"><pre><span></span><code>v4l2-ctl --set-fmt-video<span class="o">=</span><span class="nv">width</span><span class="o">=</span><span class="m">1920</span>,height<span class="o">=</span><span class="m">1088</span>,pixelformat<span class="o">=</span><span class="m">4</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
v4l2-ctl --stream-mmap<span class="o">=</span><span class="m">3</span> --stream-count<span class="o">=</span><span class="m">100</span> --stream-to<span class="o">=</span>somefile.264
</code></pre></div>
<h2 id="5-ffmpeg">5. FFmpeg<a class="headerlink" href="#5-ffmpeg" title="Permanent link">⚓︎</a></h2>
<p>The pre-built <code>ffmpeg</code> package of Pi already enables hardware accelerator support, with OpenMAX IL H.264 video encoder (<code>h264_omx</code>).</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install ffmpeg -y
</code></pre></div>
<div class="admonition tip nt">
<p class="admonition-title"> </p>
<p>An FFmpeg version with a specific library can be built by following this topic <a href="../compile-ffmpeg/">Compile FFmpeg with Hardware Accelerator</a>.</p>
</div>
<h3 id="51-encoders">5.1. Encoders<a class="headerlink" href="#51-encoders" title="Permanent link">⚓︎</a></h3>
<p>To see all available encoders:</p>
<div class="highlight"><pre><span></span><code>ffmpeg -encoders
</code></pre></div>
<!--
<div class="highlight"><pre><span></span><code><span class="go">Encoders:</span>
<span class="go"> V..... = Video</span>
<span class="go"> A..... = Audio</span>
<span class="go"> S..... = Subtitle</span>
<span class="go"> .F.... = Frame-level multithreading</span>
<span class="go"> ..S... = Slice-level multithreading</span>
<span class="go"> ...X.. = Codec is experimental</span>
<span class="go"> ....B. = Supports draw_horiz_band</span>
<span class="go"> .....D = Supports direct rendering method 1</span>
<span class="go"> ------</span>
<span class="go"> V..... a64multi             Multicolor charset for Commodore 64 (codec a64_multi)</span>
<span class="go"> V..... a64multi5            Multicolor charset for Commodore 64, extended with 5th color (colram) (codec a64_multi5)</span>
<span class="go"> V..... alias_pix            Alias/Wavefront PIX image</span>
<span class="go"> V..... amv                  AMV Video</span>
<span class="go"> V..... apng                 APNG (Animated Portable Network Graphics) image</span>
<span class="go"> V..... asv1                 ASUS V1</span>
<span class="go"> V..... asv2                 ASUS V2</span>
<span class="go"> V..X.. libaom-av1           libaom AV1 (codec av1)</span>
<span class="go"> V..... avrp                 Avid 1:1 10-bit RGB Packer</span>
<span class="go"> V..X.. avui                 Avid Meridien Uncompressed</span>
<span class="go"> V..... ayuv                 Uncompressed packed MS 4:4:4:4</span>
<span class="go"> V..... bmp                  BMP (Windows and OS/2 bitmap)</span>
<span class="go"> V..... libxavs              libxavs Chinese AVS (Audio Video Standard) (codec cavs)</span>
<span class="go"> VF.... cfhd                 GoPro CineForm HD</span>
<span class="go"> V..... cinepak              Cinepak</span>
<span class="go"> V..... cljr                 Cirrus Logic AccuPak</span>
<span class="go"> V.S... vc2                  SMPTE VC-2 (codec dirac)</span>
<span class="go"> VFS... dnxhd                VC3/DNxHD</span>
<span class="go"> V..... dpx                  DPX (Digital Picture Exchange) image</span>
<span class="go"> VFS... dvvideo              DV (Digital Video)</span>
<span class="go"> V.S... ffv1                 FFmpeg video codec #1</span>
<span class="go"> VF.... ffvhuff              Huffyuv FFmpeg variant</span>
<span class="go"> V..... fits                 Flexible Image Transport System</span>
<span class="go"> V..... flashsv              Flash Screen Video</span>
<span class="go"> V..... flashsv2             Flash Screen Video Version 2</span>
<span class="go"> V..... flv                  FLV / Sorenson Spark / Sorenson H.263 (Flash Video) (codec flv1)</span>
<span class="go"> V..... gif                  GIF (Graphics Interchange Format)</span>
<span class="go"> V..... h261                 H.261</span>
<span class="go"> V..... h263                 H.263 / H.263-1996</span>
<span class="go"> V..... h263_v4l2m2m         V4L2 mem2mem H.263 encoder wrapper (codec h263)</span>
<span class="go"> V.S... h263p                H.263+ / H.263-1998 / H.263 version 2</span>
<span class="go"> V..... libx264              libx264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 (codec h264)</span>
<span class="go"> V..... libx264rgb           libx264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 RGB (codec h264)</span>
<span class="go"> V..... h264_omx             OpenMAX IL H.264 video encoder (codec h264)</span>
<span class="go"> V..... h264_v4l2m2m         V4L2 mem2mem H.264 encoder wrapper (codec h264)</span>
<span class="go"> V..... hap                  Vidvox Hap</span>
<span class="go"> V..... libx265              libx265 H.265 / HEVC (codec hevc)</span>
<span class="go"> V..... hevc_v4l2m2m         V4L2 mem2mem HEVC encoder wrapper (codec hevc)</span>
<span class="go"> V..... libkvazaar           libkvazaar H.265 / HEVC (codec hevc)</span>
<span class="go"> VF.... huffyuv              Huffyuv / HuffYUV</span>
<span class="go"> V..... jpeg2000             JPEG 2000</span>
<span class="go"> VF.... libopenjpeg          OpenJPEG JPEG 2000 (codec jpeg2000)</span>
<span class="go"> VF.... jpegls               JPEG-LS</span>
<span class="go"> VF.... ljpeg                Lossless JPEG</span>
<span class="go"> VF.... magicyuv             MagicYUV video</span>
<span class="go"> VFS... mjpeg                MJPEG (Motion JPEG)</span>
<span class="go"> V.S... mpeg1video           MPEG-1 video</span>
<span class="go"> V.S... mpeg2video           MPEG-2 video</span>
<span class="go"> V.S... mpeg4                MPEG-4 part 2</span>
<span class="go"> V..... libxvid              libxvidcore MPEG-4 part 2 (codec mpeg4)</span>
<span class="go"> V..... mpeg4_omx            OpenMAX IL MPEG-4 video encoder (codec mpeg4)</span>
<span class="go"> V..... mpeg4_v4l2m2m        V4L2 mem2mem MPEG4 encoder wrapper (codec mpeg4)</span>
<span class="go"> V..... msmpeg4v2            MPEG-4 part 2 Microsoft variant version 2</span>
<span class="go"> V..... msmpeg4              MPEG-4 part 2 Microsoft variant version 3 (codec msmpeg4v3)</span>
<span class="go"> V..... msvideo1             Microsoft Video-1</span>
<span class="go"> V..... pam                  PAM (Portable AnyMap) image</span>
<span class="go"> V..... pbm                  PBM (Portable BitMap) image</span>
<span class="go"> V..... pcx                  PC Paintbrush PCX image</span>
<span class="go"> V..... pgm                  PGM (Portable GrayMap) image</span>
<span class="go"> V..... pgmyuv               PGMYUV (Portable GrayMap YUV) image</span>
<span class="go"> VF.... png                  PNG (Portable Network Graphics) image</span>
<span class="go"> V..... ppm                  PPM (Portable PixelMap) image</span>
<span class="go"> VF.... prores               Apple ProRes</span>
<span class="go"> VF.... prores_aw            Apple ProRes (codec prores)</span>
<span class="go"> VFS... prores_ks            Apple ProRes (iCodec Pro) (codec prores)</span>
<span class="go"> V..... qtrle                QuickTime Animation (RLE) video</span>
<span class="go"> V..... r10k                 AJA Kona 10-bit RGB Codec</span>
<span class="go"> V..... r210                 Uncompressed RGB 10-bit</span>
<span class="go"> V..... rawvideo             raw video</span>
<span class="go"> V..... roqvideo             id RoQ video (codec roq)</span>
<span class="go"> V..... rpza                 QuickTime video (RPZA)</span>
<span class="go"> V..... rv10                 RealVideo 1.0</span>
<span class="go"> V..... rv20                 RealVideo 2.0</span>
<span class="go"> V..... sgi                  SGI image</span>
<span class="go"> V..... snow                 Snow</span>
<span class="go"> V..... speedhq              NewTek SpeedHQ</span>
<span class="go"> V..... sunrast              Sun Rasterfile image</span>
<span class="go"> V..... svq1                 Sorenson Vector Quantizer 1 / Sorenson Video 1 / SVQ1</span>
<span class="go"> V..... targa                Truevision Targa image</span>
<span class="go"> V..... libtheora            libtheora Theora (codec theora)</span>
<span class="go"> VF.... tiff                 TIFF image</span>
<span class="go"> VF.... utvideo              Ut Video</span>
<span class="go"> V..... v210                 Uncompressed 4:2:2 10-bit</span>
<span class="go"> V..... v308                 Uncompressed packed 4:4:4</span>
<span class="go"> V..... v408                 Uncompressed packed QT 4:4:4:4</span>
<span class="go"> V..... v410                 Uncompressed 4:4:4 10-bit</span>
<span class="go"> V..... libvpx               libvpx VP8 (codec vp8)</span>
<span class="go"> V..... vp8_v4l2m2m          V4L2 mem2mem VP8 encoder wrapper (codec vp8)</span>
<span class="go"> V..... libvpx-vp9           libvpx VP9 (codec vp9)</span>
<span class="go"> V..... libwebp_anim         libwebp WebP image (codec webp)</span>
<span class="go"> V..... libwebp              libwebp WebP image (codec webp)</span>
<span class="go"> V..... wmv1                 Windows Media Video 7</span>
<span class="go"> V..... wmv2                 Windows Media Video 8</span>
<span class="go"> V..... wrapped_avframe      AVFrame to AVPacket passthrough</span>
<span class="go"> V..... xbm                  XBM (X BitMap) image</span>
<span class="go"> V..... xface                X-face image</span>
<span class="go"> V..... xwd                  XWD (X Window Dump) image</span>
<span class="go"> V..... y41p                 Uncompressed YUV 4:1:1 12-bit</span>
<span class="go"> V..... yuv4                 Uncompressed packed 4:2:0</span>
<span class="go"> VF.... zlib                 LCL (LossLess Codec Library) ZLIB</span>
<span class="go"> V..... zmbv                 Zip Motion Blocks Video</span>
<span class="go"> A..... aac                  AAC (Advanced Audio Coding)</span>
<span class="go"> A..... libfdk_aac           Fraunhofer FDK AAC (codec aac)</span>
<span class="go"> A..... ac3                  ATSC A/52A (AC-3)</span>
<span class="go"> A..... ac3_fixed            ATSC A/52A (AC-3) (codec ac3)</span>
<span class="go"> A..... adpcm_adx            SEGA CRI ADX ADPCM</span>
<span class="go"> A..... adpcm_argo           ADPCM Argonaut Games</span>
<span class="go"> A..... g722                 G.722 ADPCM (codec adpcm_g722)</span>
<span class="go"> A..... g726                 G.726 ADPCM (codec adpcm_g726)</span>
<span class="go"> A..... g726le               G.726 little endian ADPCM (&quot;right-justified&quot;) (codec adpcm_g726le)</span>
<span class="go"> A..... adpcm_ima_alp        ADPCM IMA High Voltage Software ALP</span>
<span class="go"> A..... adpcm_ima_amv        ADPCM IMA AMV</span>
<span class="go"> A..... adpcm_ima_apm        ADPCM IMA Ubisoft APM</span>
<span class="go"> A..... adpcm_ima_qt         ADPCM IMA QuickTime</span>
<span class="go"> A..... adpcm_ima_ssi        ADPCM IMA Simon &amp; Schuster Interactive</span>
<span class="go"> A..... adpcm_ima_wav        ADPCM IMA WAV</span>
<span class="go"> A..... adpcm_ms             ADPCM Microsoft</span>
<span class="go"> A..... adpcm_swf            ADPCM Shockwave Flash</span>
<span class="go"> A..... adpcm_yamaha         ADPCM Yamaha</span>
<span class="go"> A..... alac                 ALAC (Apple Lossless Audio Codec)</span>
<span class="go"> A..... libopencore_amrnb    OpenCORE AMR-NB (Adaptive Multi-Rate Narrow-Band) (codec amr_nb)</span>
<span class="go"> A..... libvo_amrwbenc       Android VisualOn AMR-WB (Adaptive Multi-Rate Wide-Band) (codec amr_wb)</span>
<span class="go"> A..... aptx                 aptX (Audio Processing Technology for Bluetooth)</span>
<span class="go"> A..... aptx_hd              aptX HD (Audio Processing Technology for Bluetooth)</span>
<span class="go"> A..... libcodec2            codec2 encoder using libcodec2 (codec codec2)</span>
<span class="go"> A..... comfortnoise         RFC 3389 comfort noise generator</span>
<span class="go"> A..X.. dca                  DCA (DTS Coherent Acoustics) (codec dts)</span>
<span class="go"> A..... eac3                 ATSC A/52 E-AC-3</span>
<span class="go"> A..... flac                 FLAC (Free Lossless Audio Codec)</span>
<span class="go"> A..... g723_1               G.723.1</span>
<span class="go"> A..... libgsm               libgsm GSM (codec gsm)</span>
<span class="go"> A..... libgsm_ms            libgsm GSM Microsoft variant (codec gsm_ms)</span>
<span class="go"> A..X.. mlp                  MLP (Meridian Lossless Packing)</span>
<span class="go"> A..... mp2                  MP2 (MPEG audio layer 2)</span>
<span class="go"> A..... mp2fixed             MP2 fixed point (MPEG audio layer 2) (codec mp2)</span>
<span class="go"> A..... libtwolame           libtwolame MP2 (MPEG audio layer 2) (codec mp2)</span>
<span class="go"> A..... libmp3lame           libmp3lame MP3 (MPEG audio layer 3) (codec mp3)</span>
<span class="go"> A..... libshine             libshine MP3 (MPEG audio layer 3) (codec mp3)</span>
<span class="go"> A..... nellymoser           Nellymoser Asao</span>
<span class="go"> A..X.. opus                 Opus</span>
<span class="go"> A..... libopus              libopus Opus (codec opus)</span>
<span class="go"> A..... pcm_alaw             PCM A-law / G.711 A-law</span>
<span class="go"> A..... pcm_dvd              PCM signed 16|20|24-bit big-endian for DVD media</span>
<span class="go"> A..... pcm_f32be            PCM 32-bit floating point big-endian</span>
<span class="go"> A..... pcm_f32le            PCM 32-bit floating point little-endian</span>
<span class="go"> A..... pcm_f64be            PCM 64-bit floating point big-endian</span>
<span class="go"> A..... pcm_f64le            PCM 64-bit floating point little-endian</span>
<span class="go"> A..... pcm_mulaw            PCM mu-law / G.711 mu-law</span>
<span class="go"> A..... pcm_s16be            PCM signed 16-bit big-endian</span>
<span class="go"> A..... pcm_s16be_planar     PCM signed 16-bit big-endian planar</span>
<span class="go"> A..... pcm_s16le            PCM signed 16-bit little-endian</span>
<span class="go"> A..... pcm_s16le_planar     PCM signed 16-bit little-endian planar</span>
<span class="go"> A..... pcm_s24be            PCM signed 24-bit big-endian</span>
<span class="go"> A..... pcm_s24daud          PCM D-Cinema audio signed 24-bit</span>
<span class="go"> A..... pcm_s24le            PCM signed 24-bit little-endian</span>
<span class="go"> A..... pcm_s24le_planar     PCM signed 24-bit little-endian planar</span>
<span class="go"> A..... pcm_s32be            PCM signed 32-bit big-endian</span>
<span class="go"> A..... pcm_s32le            PCM signed 32-bit little-endian</span>
<span class="go"> A..... pcm_s32le_planar     PCM signed 32-bit little-endian planar</span>
<span class="go"> A..... pcm_s64be            PCM signed 64-bit big-endian</span>
<span class="go"> A..... pcm_s64le            PCM signed 64-bit little-endian</span>
<span class="go"> A..... pcm_s8               PCM signed 8-bit</span>
<span class="go"> A..... pcm_s8_planar        PCM signed 8-bit planar</span>
<span class="go"> A..... pcm_u16be            PCM unsigned 16-bit big-endian</span>
<span class="go"> A..... pcm_u16le            PCM unsigned 16-bit little-endian</span>
<span class="go"> A..... pcm_u24be            PCM unsigned 24-bit big-endian</span>
<span class="go"> A..... pcm_u24le            PCM unsigned 24-bit little-endian</span>
<span class="go"> A..... pcm_u32be            PCM unsigned 32-bit big-endian</span>
<span class="go"> A..... pcm_u32le            PCM unsigned 32-bit little-endian</span>
<span class="go"> A..... pcm_u8               PCM unsigned 8-bit</span>
<span class="go"> A..... pcm_vidc             PCM Archimedes VIDC</span>
<span class="go"> A..... real_144             RealAudio 1.0 (14.4K) (codec ra_144)</span>
<span class="go"> A..... roq_dpcm             id RoQ DPCM</span>
<span class="go"> A..X.. s302m                SMPTE 302M</span>
<span class="go"> A..... sbc                  SBC (low-complexity subband codec)</span>
<span class="go"> A..X.. sonic                Sonic</span>
<span class="go"> A..X.. sonicls              Sonic lossless</span>
<span class="go"> A..... libspeex             libspeex Speex (codec speex)</span>
<span class="go"> A..X.. truehd               TrueHD</span>
<span class="go"> A..... tta                  TTA (True Audio)</span>
<span class="go"> A..X.. vorbis               Vorbis</span>
<span class="go"> A..... libvorbis            libvorbis (codec vorbis)</span>
<span class="go"> A..... wavpack              WavPack</span>
<span class="go"> A..... wmav1                Windows Media Audio 1</span>
<span class="go"> A..... wmav2                Windows Media Audio 2</span>
<span class="go"> S..... ssa                  ASS (Advanced SubStation Alpha) subtitle (codec ass)</span>
<span class="go"> S..... ass                  ASS (Advanced SubStation Alpha) subtitle</span>
<span class="go"> S..... dvbsub               DVB subtitles (codec dvb_subtitle)</span>
<span class="go"> S..... dvdsub               DVD subtitles (codec dvd_subtitle)</span>
<span class="go"> S..... mov_text             3GPP Timed Text subtitle</span>
<span class="go"> S..... srt                  SubRip subtitle (codec subrip)</span>
<span class="go"> S..... subrip               SubRip subtitle</span>
<span class="go"> S..... text                 Raw text subtitle</span>
<span class="go"> S..... webvtt               WebVTT subtitle</span>
<span class="go"> S..... xsub                 DivX subtitles (XSUB)</span>
</code></pre></div>
-->
<p>If interested in <code>h264</code> and <code>mjpeg</code>, use <code>grep</code> to search for the specific encoders:</p>
<div class="highlight"><pre><span></span><code>ffmpeg -hide_banner -encoders <span class="p">|</span> grep -E <span class="s2">"h264|mjpeg"</span>
</code></pre></div>
<div class="log">
<div class="highlight"><pre><span></span><code><span class="go">V..... libx264              libx264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 (codec h264)</span>
<span class="go">V..... libx264rgb           libx264 H.264 / AVC / MPEG-4 AVC / MPEG-4 part 10 RGB (codec h264)</span>
<span class="go">V..... h264_omx             OpenMAX IL H.264 video encoder (codec h264)</span>
<span class="go">V..... h264_v4l2m2m         V4L2 mem2mem H.264 encoder wrapper (codec h264)</span>
<span class="go">VFS... mjpeg                MJPEG (Motion JPEG)</span>
</code></pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Check encoder options</p>
<p>Before using an encoder, check its options by <code>help</code> command in <code>ffmpeg</code>.</p>
<div class="highlight"><pre><span></span><code>ffmpeg -h <span class="nv">encoder</span><span class="o">=</span>&lt;format&gt;
</code></pre></div>
</div>
<p>Here is the list of formats supported by OpenMAX IL H.264 video encoder (h264_omx):</p>
<div class="highlight"><pre><span></span><code>ffmpeg -h <span class="nv">encoder</span><span class="o">=</span>h264_omx
</code></pre></div>
<div class="log">
<div class="highlight"><pre><span></span><code><span class="go">Encoder h264_omx [OpenMAX IL H.264 video encoder]:</span>
<span class="go">    General capabilities: delay</span>
<span class="go">    Threading capabilities: none</span>
<span class="go">    Supported pixel formats: yuv420p</span>
<span class="go">h264_omx AVOptions:</span>
<span class="go">    -omx_libname       &lt;string&gt;     ED.V...... OpenMAX library name</span>
<span class="go">    -omx_libprefix     &lt;string&gt;     ED.V...... OpenMAX library prefix</span>
<span class="go">    -zerocopy          &lt;int&gt;        E..V...... Try to avoid copying input frames if possible (from 0 to 1) (default 1)</span>
<span class="go">    -profile           &lt;int&gt;        E..V...... Set the encoding profile (from -99 to 100) (default -99)</span>
<span class="go">        baseline        66          E..V......</span>
<span class="go">        main            77          E..V......</span>
<span class="go">        high            100         E..V......</span>
</code></pre></div>
</div>
<h3 id="52-performance">5.2. Performance<a class="headerlink" href="#52-performance" title="Permanent link">⚓︎</a></h3>
<p>Next, try to record some short video (60 seconds) with H264 format using different encoders. To measure the performance, use a small tool to check CPU and Memory Usage in <a href="../resource-usage/">monitor - Script to check performance</a>.</p>
<div class="admonition info nt">
<p class="admonition-title"> </p>
<p>Note that <code>ffmpeg</code> will use <code>v4l2</code> driver if user does not specify the driver!”</p>
</div>
<dl>
<dt><strong>Video settings</strong></dt>
<dd>Video side: <strong>1024x768</strong><br/>
 Framerate: <strong>30</strong> fps<br/>
 Input Length: <strong>60</strong> seconds</dd>
</dl>
<div class="np"></div>
<h4 id="521-raw-to-mjpeg-avi">5.2.1. Raw to MJPEG (.avi)<a class="headerlink" href="#521-raw-to-mjpeg-avi" title="Permanent link">⚓︎</a></h4>
<div class="highlight"><pre><span></span><code>ffmpeg -y -hide_banner <span class="se">\</span>
    -use_wallclock_as_timestamps <span class="m">1</span> <span class="se">\</span>
    -t <span class="m">60</span> <span class="se">\</span>
    -i /dev/video0 <span class="se">\</span>
<span class="hll">    -c:v mjpeg <span class="se">\</span>
</span>    raw_mjpeg.avi
</code></pre></div>
<ul>
<li>
<p>Performance:</p>
<ul>
<li>Total time: 63 seconds</li>
<li>Average CPU: <em class="new-span" style="color:darkred">93 (too high)</em></li>
<li>Average MEM: 31</li>
<li>Input FPS: <em class="new-span" style="color:darkred">4.8 (dropped input)</em></li>
<li>Output FPS: 30</li>
</ul>
</li>
<li>
<p>Quality:</p>
<ul>
<li>Format: JPEG</li>
<li>Codec ID: MJPG</li>
<li>Bit rate: 839 kb/s</li>
</ul>
</li>
</ul>
<p>
<figure class="w70"><img src="raw_mjpeg/raw_mjpeg_usage.png"/><figcaption>Raw to MJPEG</figcaption></figure>
</p>
<div class="np"></div>
<h4 id="522-raw-to-h264_omx-8mbps-mp4">5.2.2. Raw to H264_OMX @8Mbps (.mp4)<a class="headerlink" href="#522-raw-to-h264_omx-8mbps-mp4" title="Permanent link">⚓︎</a></h4>
<div class="highlight"><pre><span></span><code>ffmpeg -y -hide_banner <span class="se">\</span>
    -use_wallclock_as_timestamps <span class="m">1</span> <span class="se">\</span>
    -t <span class="m">60</span> <span class="se">\</span>
    -i /dev/video0 <span class="se">\</span>
<span class="hll">    -c:v h264_omx <span class="se">\</span>
</span><span class="hll">    -b:v 8M <span class="se">\</span>
</span>    raw_h264omx.mp4
</code></pre></div>
<ul>
<li>
<p>Performance:</p>
<ul>
<li>Total time: 63 seconds</li>
<li>Average CPU: <em class="new-span" style="color:darkgreen">16 (OK)</em></li>
<li>Average MEM: 27</li>
<li>Input FPS: 30</li>
<li>Output FPS: 30</li>
</ul>
</li>
<li>
<p>Quality:</p>
<ul>
<li>Format: AVC (GOP: M=1, N=12)</li>
<li>Codec ID: avc1</li>
<li>Bit rate: 2 877 kb/s</li>
</ul>
</li>
</ul>
<p>
<figure class="w70"><img src="raw_h264omx/raw_h264omx_usage.png"/><figcaption>Raw to H264_OMX @8Mbps</figcaption></figure>
</p>
<div class="np"></div>
<h4 id="523-raw-to-h264_v4l2m2m-8mbps-mp4">5.2.3. Raw to H264_V4L2M2M @8Mbps (.mp4)<a class="headerlink" href="#523-raw-to-h264_v4l2m2m-8mbps-mp4" title="Permanent link">⚓︎</a></h4>
<div class="highlight"><pre><span></span><code>ffmpeg -y -hide_banner <span class="se">\</span>
    -use_wallclock_as_timestamps <span class="m">1</span> <span class="se">\</span>
    -t <span class="m">60</span> <span class="se">\</span>
    -i /dev/video0 <span class="se">\</span>
<span class="hll">    -c:v h264_v4l2m2m <span class="se">\</span>
</span><span class="hll">    -b:v 8M <span class="se">\</span>
</span>    raw_h264v4l2m2m.mp4
</code></pre></div>
<ul>
<li>
<p>Performance:</p>
<ul>
<li>Total time: 62 seconds</li>
<li>Average CPU: 23</li>
<li>Average MEM: 27</li>
<li>Input FPS: 30</li>
<li>Output FPS: 30</li>
</ul>
</li>
<li>
<p>Quality:</p>
<ul>
<li>Format: AVC (GPO: M=1, N=60)</li>
<li>Codec ID: avc1</li>
<li>Bit rate: 1 783 kb/s</li>
</ul>
</li>
</ul>
<p>
<figure class="w70"><img src="raw_h264v4l2m2m/raw_h264v4l2m2m_usage.png"/><figcaption>Raw to H264_V4L2M2M @8Mbps</figcaption></figure>
</p>
<div class="np"></div>
<h4 id="524-v4l2-mjpeg-direct-copy-avi">5.2.4. V4L2 MJPEG direct copy (.avi)<a class="headerlink" href="#524-v4l2-mjpeg-direct-copy-avi" title="Permanent link">⚓︎</a></h4>
<div class="highlight"><pre><span></span><code>ffmpeg -y -hide_banner <span class="se">\</span>
    -use_wallclock_as_timestamps <span class="m">1</span> <span class="se">\</span>
    -t <span class="m">60</span> <span class="se">\</span>
<span class="hll">    -input_format mjpeg <span class="se">\</span>
</span>    -i /dev/video0 <span class="se">\</span>
<span class="hll">    -c:v copy <span class="se">\</span>
</span>    -t <span class="m">60</span> <span class="se">\</span>
    mjpeg_avi.avi
</code></pre></div>
<ul>
<li>
<p>Performance:</p>
<ul>
<li>Total time: 67 seconds</li>
<li>Average CPU: <strong class="new-span" style="color:darkgreen">10 (Good)</strong></li>
<li>Average MEM: 21</li>
<li>Input FPS: 30</li>
<li>Output FPS: 30</li>
</ul>
</li>
<li>
<p>Quality:</p>
<ul>
<li>Format: JPEG</li>
<li>Codec ID: MJPG</li>
<li>Bit rate: <em class="new-span" style="color:darkred">10.2 Mb/s (very high bandwidth)</em></li>
</ul>
</li>
</ul>
<p>
<figure class="w70"><img src="mjpeg_avi/mjpeg_avi_usage.png"/><figcaption>Save V4L2 MJPEG strem</figcaption></figure>
</p>
<div class="np"></div>
<h4 id="525-v4l2-h264-direct-copy-mp4">5.2.5. V4L2 H264 direct copy (.mp4)<a class="headerlink" href="#525-v4l2-h264-direct-copy-mp4" title="Permanent link">⚓︎</a></h4>
<div class="highlight"><pre><span></span><code>ffmpeg -y -hide_banner <span class="se">\</span>
    -use_wallclock_as_timestamps <span class="m">1</span> <span class="se">\</span>
    -t <span class="m">60</span> <span class="se">\</span>
<span class="hll">    -input_format h264 <span class="se">\</span>
</span>    -i /dev/video0 <span class="se">\</span>
<span class="hll">    -c:v copy <span class="se">\</span>
</span>    -t <span class="m">60</span> <span class="se">\</span>
    h264_mp4.mp4
</code></pre></div>
<ul>
<li>
<p>Performance:</p>
<ul>
<li>Total time: 67 seconds</li>
<li>Average CPU: <strong class="new-span" style="color:darkgreen">10 (Good)</strong></li>
<li>Average MEM: 24</li>
<li>Input FPS: 30</li>
<li>Output FPS: 30</li>
</ul>
</li>
<li>
<p>Quality:</p>
<ul>
<li>Format: AVC (GPO: M=1, N=60)</li>
<li>Codec ID: avc1</li>
<li>Bit rate: <em class="new-span" style="color:darkgreen">5 506 kb/s (OK)</em></li>
</ul>
</li>
</ul>
<p>
<figure class="w70"><img src="h264_mp4/h264_mp4_usage.png"/><figcaption>Save V4L2 H264 stream</figcaption></figure>
</p>
<div class="np"></div>
<h4 id="526-conclusion">5.2.6. Conclusion<a class="headerlink" href="#526-conclusion" title="Permanent link">⚓︎</a></h4>
<p>After above tests, it can be said that <mark>using compressed input format from <code>v4l2</code> is much more effective than compressing by an software encoder.</mark></p>
<p>Let’s add some timestamp to video by using <code>drawtext</code> filter with built-in expandable <code>localtime</code> variable in <a href="http://ffmpeg.org/ffmpeg-filters.html#Text-expansion">Text-expansion option</a>.</p>
<div class="highlight"><pre><span></span><code>ffmpeg -y -hide_banner <span class="se">\</span>
    -use_wallclock_as_timestamps <span class="m">1</span> <span class="se">\</span>
    -t <span class="m">10</span> <span class="se">\</span>
    -i /dev/video0 <span class="se">\</span>
    -vf <span class="s2">"drawtext=text='%{localtime}':fontcolor=white:x=100:y=100"</span> <span class="se">\</span>
    -c:v h264_omx <span class="se">\</span>
    -b:v 8M <span class="se">\</span>
    raw_h264omx_text.mp4
</code></pre></div>
<div class="admonition fail">
<p class="admonition-title">Filter and stream-copy cannot be used together</p>
<p>Text needs inserted and each frame needs re-encoded, therefore, stream-copy is unavailable.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># this will not work</span>
ffmpeg -y -hide_banner <span class="se">\</span>
    -use_wallclock_as_timestamps <span class="m">1</span> <span class="se">\</span>
    -t <span class="m">10</span> <span class="se">\</span>
    -input_format h264 <span class="se">\</span>
    -i /dev/video0 <span class="se">\</span>
    -vf <span class="s2">"drawtext=text='%{localtime}':fontcolor=white:x=100:y=100"</span> <span class="se">\</span>
    -c:v copy <span class="se">\</span>
    -t <span class="m">10</span> <span class="se">\</span>
    h264_mp4_text.mp4
</code></pre></div>
</div>
<h2 id="6-install-picamera">6. Install <code>picamera</code><a class="headerlink" href="#6-install-picamera" title="Permanent link">⚓︎</a></h2>
<p>The <a href="https://picamera.readthedocs.io/en/latest/install.html"><code>picamera</code></a> package is a pure Python interface to the Raspberry Pi camera module for Python language. If using the <a href="https://www.raspberrypi.org/downloads/raspbian/">Raspbian</a> distro, probably it has picamera installed by default. Run a test to check it is installed or not:</p>
<div class="highlight"><pre><span></span><code>python -c <span class="s2">"import picamera"</span>
python3 -c <span class="s2">"import picamera"</span>
</code></pre></div>
<p>If no module found, install <code>picamera</code> from the system’s package manager:</p>
<div class="highlight"><pre><span></span><code>sudo apt-get install python-picamera python3-picamera
</code></pre></div>
<p>There are a lot of examples in the <a href="https://picamera.readthedocs.io/en/latest/recipes1.html">official guide</a>. Here are some starting points:</p>
<p><br/>
<strong>Get maximum resolution of the camera</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">picamera</span>

<span class="k">with</span> <span class="n">picamera</span><span class="o">.</span><span class="n">PiCamera</span><span class="p">()</span> <span class="k">as</span> <span class="n">cam</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cam</span><span class="o">.</span><span class="n">MAX_RESOLUTION</span><span class="p">)</span>
</code></pre></div>
<p><br/>
<strong>Take a snapshot</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">picamera</span> <span class="kn">import</span> <span class="n">PiCamera</span>

<span class="c1"># setup a camera</span>
<span class="n">camera</span> <span class="o">=</span> <span class="n">PiCamera</span><span class="p">()</span>
<span class="n">camera</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>

<span class="c1"># camera warm-up time</span>
<span class="n">sleep</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># capture an image</span>
<span class="n">camera</span><span class="o">.</span><span class="n">capture</span><span class="p">(</span><span class="s1">'snapshot.jpg'</span><span class="p">)</span>
</code></pre></div>
<p>Now, for the testing purpose, let’s record a 60-second video from the camera and measure the resource usage with <code>monitor</code>, then use <code>ffmpeg</code> to convert raw h264 to mp4:</p>
<h3 id="61-picamera-h264-h264">6.1. Picamera H264 (.h264)<a class="headerlink" href="#61-picamera-h264-h264" title="Permanent link">⚓︎</a></h3>
<p><br/>
<strong>Recode a raw H264 video file</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">picamera</span> <span class="kn">import</span> <span class="n">PiCamera</span>

<span class="c1"># setup a camera</span>
<span class="n">camera</span> <span class="o">=</span> <span class="n">PiCamera</span><span class="p">()</span>
<span class="n">camera</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>
<span class="n">camera</span><span class="o">.</span><span class="n">framerate</span> <span class="o">=</span> <span class="mi">30</span>

<span class="c1"># record a video</span>
<span class="n">camera</span><span class="o">.</span><span class="n">start_recording</span><span class="p">(</span><span class="s1">'picamera.h264'</span><span class="p">)</span>
<span class="n">camera</span><span class="o">.</span><span class="n">wait_recording</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
<span class="n">camera</span><span class="o">.</span><span class="n">stop_recording</span><span class="p">()</span>
</code></pre></div>
<p><br/>
<strong>Convert to MP4 video file</strong></p>
<div class="highlight"><pre><span></span><code>ffmpeg -i picamera.h264 <span class="se">\</span>
    -c:v copy picamera.mp4
</code></pre></div>
<ul>
<li>
<p>Performance:</p>
<ul>
<li>Total time: 61 seconds</li>
<li>Average CPU: <strong class="new-span" style="color:darkgreen">11 (Good)</strong></li>
<li>Average MEM: <strong class="new-span" style="color:darkgreen">5 (Good)</strong></li>
<li>Input FPS: 30</li>
<li>Output FPS: <strong>25</strong></li>
</ul>
</li>
<li>
<p>Quality:</p>
<ul>
<li>Format: AVC (GPO: M=1, N=60)</li>
<li>Codec ID: avc1</li>
<li>Bit rate: <em class="new-span" style="color:darkgreen">3 302 kb/s (Good)</em></li>
</ul>
</li>
</ul>
<p>
<figure class="w70"><img src="picamera_h264/picamera_h264_usage.png"/><figcaption>Picamera</figcaption></figure>
</p>
<h3 id="62-picamera-h264-h264-with-text-overlay">6.2. Picamera H264 (.h264) with Text overlay<a class="headerlink" href="#62-picamera-h264-h264-with-text-overlay" title="Permanent link">⚓︎</a></h3>
<p>Now, try to detect how <code>picamera</code> can draw text on output video. Here is the test code:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span> <span class="nn">picamera</span> <span class="kn">import</span> <span class="n">PiCamera</span>
<span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">TIMEFMT</span> <span class="o">=</span> <span class="s1">'%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S.</span><span class="si">%f</span><span class="s1">'</span>

<span class="c1"># setup a camera</span>
<span class="n">camera</span> <span class="o">=</span> <span class="n">PiCamera</span><span class="p">()</span>
<span class="n">camera</span><span class="o">.</span><span class="n">resolution</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="mi">768</span><span class="p">)</span>
<span class="n">camera</span><span class="o">.</span><span class="n">annotate_text</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">TIMEFMT</span><span class="p">)</span>

<span class="c1"># record a video</span>
<span class="n">camera</span><span class="o">.</span><span class="n">start_recording</span><span class="p">(</span><span class="s1">'picamera_text.h264'</span><span class="p">)</span>
<span class="n">start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>

<span class="k">while</span> <span class="p">(</span><span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span><span class="o">.</span><span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
  <span class="n">camera</span><span class="o">.</span><span class="n">annotate_text</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="n">TIMEFMT</span><span class="p">)</span>
  <span class="n">camera</span><span class="o">.</span><span class="n">wait_recording</span><span class="p">(</span><span class="mf">0.04</span><span class="p">)</span> <span class="c1"># 25fps</span>

<span class="c1"># stop it</span>
<span class="n">camera</span><span class="o">.</span><span class="n">stop_recording</span><span class="p">()</span>
</code></pre></div>
<p>Using <code>picamera</code> shows an impressive CPU and MEM usage, comparing to using FFmpeg. The result shows that the CPU uses twice as much as it does in non-overlay text, while the MEM keeps the same percentage.</p>
<div data-value="https://www.codeinsideout.com/blog/pi/setup-camera/" id="page_url"></div>
<div data-value="blog/pi/setup-camera/" id="page_identifier"></div>
<div>
<h2 id="__comments">Comments</h2>
<div id="disqus_thread"></div>
<script>var disqus_config = function () { this.page.url = "https://www.codeinsideout.com/blog/pi/setup-camera/", this.page.identifier = "blog/pi/setup-camera/" }; window.addEventListener("load", function () { var e = document, i = e.createElement("script"); i.src = "//vuquangtrong-github-io.disqus.com/embed.js", i.setAttribute("data-timestamp", +new Date), (e.head || e.body).appendChild(i) })</script>
</div>
</article>
</div>
</div>
<a class="md-top md-icon" data-md-component="top" data-md-state="hidden" href="#">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path></svg>
            Back to top
          </a>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Resource usage" class="md-footer__link md-footer__link--prev" href="../resource-usage/" rel="prev">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"></path></svg>
</div>
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Previous
              </span>
              Resource usage
            </div>
</div>
</a>
<a aria-label="Next: HLS/DASH Streaming" class="md-footer__link md-footer__link--next" href="../stream-ffmpeg-hls-dash/" rel="next">
<div class="md-footer__title">
<div class="md-ellipsis">
<span class="md-footer__direction">
                Next
              </span>
              HLS/DASH Streaming
            </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
<div class="md-footer-copyright__highlight">
            © 2021 Code Inside Out <div style="display:none"><div>
</div>
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
<div>
    using
    <a href="https://github.com/vuquangtrong/mkdocs-material-blog">
        MkDocs Material Blog
    </a>
    theme
</div>
</div>
</div>
<div class="md-footer-social">
<a class="md-footer-social__link" href="https://github.com/vuquangtrong" rel="noopener" target="_blank" title="vuquangtrong">
<svg viewbox="0 0 480 512" xmlns="http://www.w3.org/2000/svg"><path d="M186.1 328.7c0 20.9-10.9 55.1-36.7 55.1s-36.7-34.2-36.7-55.1 10.9-55.1 36.7-55.1 36.7 34.2 36.7 55.1zM480 278.2c0 31.9-3.2 65.7-17.5 95-37.9 76.6-142.1 74.8-216.7 74.8-75.8 0-186.2 2.7-225.6-74.8-14.6-29-20.2-63.1-20.2-95 0-41.9 13.9-81.5 41.5-113.6-5.2-15.8-7.7-32.4-7.7-48.8 0-21.5 4.9-32.3 14.6-51.8 45.3 0 74.3 9 108.8 36 29-6.9 58.8-10 88.7-10 27 0 54.2 2.9 80.4 9.2 34-26.7 63-35.2 107.8-35.2 9.8 19.5 14.6 30.3 14.6 51.8 0 16.4-2.6 32.7-7.7 48.2 27.5 32.4 39 72.3 39 114.2zm-64.3 50.5c0-43.9-26.7-82.6-73.5-82.6-18.9 0-37 3.4-56 6-14.9 2.3-29.8 3.2-45.1 3.2-15.2 0-30.1-.9-45.1-3.2-18.7-2.6-37-6-56-6-46.8 0-73.5 38.7-73.5 82.6 0 87.8 80.4 101.3 150.4 101.3h48.2c70.3 0 150.6-13.4 150.6-101.3zm-82.6-55.1c-25.8 0-36.7 34.2-36.7 55.1s10.9 55.1 36.7 55.1 36.7-34.2 36.7-55.1-10.9-55.1-36.7-55.1z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://facebook.com/trongvq" rel="noopener" target="_blank" title="trongvq">
<svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><path d="m279.14 288 14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43 0 225.36 0c-73.22 0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"></path></svg>
</a>
<a class="md-footer-social__link" href="https://www.linkedin.com/in/vqtrong" rel="noopener" target="_blank" title="vqtrong">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3zM447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../../..", "features": ["navigation.instant", "navigation.tabs", "navigation.top", "header.autohide", "search.suggest", "search.highlight"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../../../assets/javascripts/workers/search.709b4209.min.js", "version": null}</script>
<script src="../../../assets/javascripts/bundle.2b46852b.min.js"></script>
<script src="../../../assets/view-bigimg.js"></script>
<script src="../../../assets/extra.js"></script>
</body>
</html>